!function(t){function e(e){for(var r,o,u=e[0],s=e[1],l=e[2],f=0,d=[];f<u.length;f++)o=u[f],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);for(c&&c(e);d.length;)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,u=1;u<n.length;u++){var s=n[u];0!==i[s]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},i={0:0},a=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var u=window.webpackJsonp=window.webpackJsonp||[],s=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var c=s;a.push([73,1]),n()}([,,,,,function(t,e,n){var r=n(103);try{window;n(104)(r),n(124)(r),n(125)(r),n(128)(r),n(130)(r),n(131)(r),n(137)(r),n(138)(r),n(139)(r),n(68)(r)}catch(t){}t.exports=r},,function(t,e,n){var r=t.exports={},i=r.canvas=i=document.createElement("canvas"),a=r.gl=window.gl=twgl.getContext(i,{premultipliedAlpha:!1});twgl.addExtensionsToContext(a),r.getImage=n(161),r.easyFilter=n(162)},,,,,,,function(t,e,n){var r=o(n(141)),i=o(n(6)),a=o(n(144));function o(t){return t&&t.__esModule?t:{default:t}}var u=function(t,e){e=null==e?[]:[e];var n=this;this.$trigger=function(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"up";for(var o in(i=i||{}).type=i.type||t,i.target=i.target||n,i.mit=n,r)null!=r[o].key&&r[o].key!=i.key&&r[o].key!=i.action||r[o].f(i);for(var o in e)e[o].$trigger(i,a)},this.$pushParent=function(t){for(var n=0;n<e.length;n++)if(t==e[n])return;e.push(t)},this.$removeParent=function(t){for(var n=0;n<e.length;n++)if(e[n]==t)return void e.splice(n,1)};var r=[];this.$listen=function(t,e){"function"==typeof t&&(e=t,t=null),r.push({f:e,key:t})},this.$unlisten=function(t){for(var e=r.length-1;e>=0;e--)r[e].f==t&&r.splice(e,1)},Object.defineProperty(this,"$trigger",{enumerable:!1}),Object.defineProperty(this,"$pushParent",{enumerable:!1}),Object.defineProperty(this,"$removeParent",{enumerable:!1}),Object.defineProperty(this,"$listen",{enumerable:!1}),Object.defineProperty(this,"$unlisten",{enumerable:!1})},s=function(t){if(null!=t.length)return!1;for(var e in t)if("x"!=e&&"y"!=e)return!1;return!0},l=function t(e,n,r){if(null==e)return e;if("boolean"==typeof n&&(n={tree:n}),n=n||{},t.isCamera(e))return r&&e.$pushParent(r),e;if(e instanceof Array)return new f(e,n,r);u.call(this,"object",r);var i=this,o=this,l={},c=function(e,r){Object.prototype.__defineSetter__.call(i,e,(function(r){for(var i in p)null!=p[i].key&&p[i].key!=e||(r=p[i].func(r,e));if(r!=l[e]){if(n.tree&&t.isObject(r)&&!s(r))r=new t(r,n,o);t.isCamera(l[e])&&l[e].$removeParent(o),l[e]=r,o.$trigger({key:e,value:r})}})),Object.prototype.__defineGetter__.call(i,e,(function(){return l[e]})),o.$trigger({key:e,value:r})},d=function(e,r){if(n.tree&&t.isObject(r))r=new t(r,n,o);o[e]=r,l[e]=r,c(e,r)};this.$set=function(e,r){if("string"==typeof e){var i={};i[e]=r,e=i}for(var u in e){r=e[u];n.tree&&t.isObject(r)&&!s(r)&&(r=new t(r,n,o)),(0,a.default)(l).indexOf(u)<0&&c(u,r),this[u]=r}};var p=[];for(var h in this.$setter=function(t,e){"function"==typeof t&&(e=t,t=null),p.push({key:t,func:e})},this.$get=function(){var e={};for(var r in l)n.tree&&t.isCamera(l[r])?e[r]=l[r].$get():e[r]=l[r];return e},this.$load=function(e){for(var n in e)e[n]!=o[n]&&(t.isObject(e[n])&&t.isCamera(o[n])?o[n].$load(e[n]):this.$set(n,e[n]))},e)d(h,e[h]);Object.defineProperty(this,"$set",{enumerable:!1}),Object.defineProperty(this,"$setter",{enumerable:!1}),Object.defineProperty(this,"$get",{enumerable:!1}),Object.defineProperty(this,"$load",{enumerable:!1})},c=function(t,e,n){var r=this;u.call(this,"array",n);var i=this.push;this.push=function(){for(var t=[],n=r.length,a=0;a<arguments.length;a++)e.tree&&l.isObject(arguments[a])&&!s(arguments[a])?t.push(new l(arguments[a],e,r)):t.push(arguments[a]);t.length<=0||(i.apply(r,t),r.$trigger({action:"create",value:t,index:n}))},this.push.apply(this,t),this.delete=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],i=[],a=t+e,o=t;o<a&&o<r.length;o++)i.push(o),n.push(r[o]);n.length<=0||(r.splice(t,e),r.$trigger({action:"delete",value:i,deletes:n}))},this.remove=function(){for(var t=[],e=[],n=r.length-1;n>=0;n--)for(var i=0;i<arguments.length;i++)if(r[n]==arguments[i]){t.push(n),e.push(r[n]),r.splice(n,1);break}r.$trigger({action:"delete",value:t,deletes:e})},this.insert=function(t){for(var n=[],i=1;i<arguments.length;i++)e.tree&&l.isObject(arguments[i])&&!s(arguments[i])?n.push(new l(arguments[i],e,r)):n.push(arguments[i]);if(!(n.length<=0)){var a=[t,0];for(var i in n)a.push(n[i]);r.splice.apply(r,a),r.$trigger({action:"create",value:n,index:t})}};var a=this.sort;this.sort=function(){a.apply(r,arguments),r.$trigger({action:"sort"})};var o=this.reverse;this.reverse=function(){o.apply(r,arguments),r.$trigger({action:"sort"})},this.replaceAll=function(t){r.delete(0,r.length),r.push.apply(r,t)};this.forEach;this.forEach=function(t){for(var e=0;e<this.length;e++)t(this[e])},this.indexOf=function(t){for(var e in r)if(r[e]==t)return Number(e);return-1},this.$get=function(){for(var t=[],n=0;n<r.length;n++)e.tree&&l.isCamera(r[n])?t.push(r[n].$get()):t.push(r[n]);return t},this.$load=function(t){for(var e=Math.max(t.length,r.length)-1;e>=0;e--)e>=t.length?r.delete(e,1):t[e]!=r[e]&&(l.isObject(t[e])&&l.isCamera(r[e])?r[e].$load(t[e]):(r.delete(e,1),r.insert(e,t[e])));for(e=r.length;e<t.length;e++)r.insert(e,t[e])},Object.defineProperty(this,"$load",{enumerable:!1}),Object.defineProperty(this,"$get",{enumerable:!1}),Object.defineProperty(this,"push",{enumerable:!1}),Object.defineProperty(this,"delete",{enumerable:!1}),Object.defineProperty(this,"remove",{enumerable:!1}),Object.defineProperty(this,"insert",{enumerable:!1}),Object.defineProperty(this,"sort",{enumerable:!1}),Object.defineProperty(this,"reverse",{enumerable:!1}),Object.defineProperty(this,"replaceAll",{enumerable:!1}),Object.defineProperty(this,"forEach",{enumerable:!1}),Object.defineProperty(this,"indexOf",{enumerable:!1}),Object.defineProperty(this,"__isCamera",{enumerable:!1,value:!0})},f=function(){var t=new Array;return Object.defineProperty(t,"length",{enumerable:!1}),c.apply(t,arguments),t};l.isCamera=function(t){return t instanceof l||t instanceof f||t instanceof Array&&1==t.__isCamera},l.isObject=function(t){return null!=t&&("object"==(void 0===t?"undefined":(0,i.default)(t))&&((0,r.default)(t).constructor==Object||(0,r.default)(t).constructor==Array))},t.exports=l;try{n(5).Camera=l}catch(t){}n(147)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(71),i=t.exports=new r;i.addLib("base-data","#version 300 es\nprecision highp float;\n\n//粒子信息结构体\nstruct Particle {\n\t//坐标\n    vec3 position;\n    //速度\n    vec3 velocity;\n    //加速度\n   \tvec3 gravity;\n   \t//颜色\n   \tvec4 color;\n   \t//权重\n   \tfloat weight;\n   \t//生存时间\n   \tfloat life;\n};\n\n//尺寸\nuniform vec2 uDataSize;\n//随机种子\nuniform float uRandSeed;\n//粒子数量\nuniform float uCount;\n//输入层\nuniform sampler2D uPs;\nuniform sampler2D uVs;\nuniform sampler2D uGs;\nuniform sampler2D uCs;\n\n//根据UV获取粒子\nParticle getParticleOfUV(vec2 uv){\n\t//读取顶点数据\n\tvec4 cp = texture(uPs,uv);\n\tvec4 cv = texture(uVs,uv);\n\tvec4 cg = texture(uGs,uv);\n\tvec4 cc = texture(uCs,uv);\n\n\t//写入粒子数据\n\tParticle p;\n\tp.position = cp.rgb;\n\tp.velocity = cv.rgb;\n\tp.gravity = cg.rgb;\n\tp.weight = cp.a;\n\tp.life = cv.a;\n\tp.color = cc;\n\n\t//返回粒子\n\treturn p;\n}\n\n//根据index获取UV\nvec2 getUVOfIndex(float index){\n\t//序号算uv\n\tvec2 uv = vec2(0,0);\n\tuv.x = mod(index,uDataSize.x);\n\tuv.y = (index - mod(index,uDataSize.x)) / uDataSize.x;\n\tuv.x = uv.x / uDataSize.x;\n\tuv.y = uv.y / uDataSize.y;\n\treturn uv;\n}\n\n//根据序号获取粒子\nParticle getParticleOfIndex(float index){\n\treturn getParticleOfUV(getUVOfIndex(index));\n}\n"),i.addLib("pf-main","#version 300 es\n\n//基本定义\n#include base-data;\n\n//UV\nin vec2 vUV;\n\n//输出层\nlayout (location = 0) out vec4 oPs;\nlayout (location = 1) out vec4 oVs;\nlayout (location = 2) out vec4 oGs;\nlayout (location = 3) out vec4 oCs;\n\n//当前点的序号\nfloat _index;\n//全局粒子\nParticle p;\n\n//随机数自增值\nfloat _randSeed = 0.0;\n//随机数\nfloat rand(){\n\t_randSeed++;\n    return fract(sin(dot(vec2((uRandSeed * 9314.5472 + _randSeed)/5298.3752,(_index)/5821.5482 + 5.725) ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n\nvoid main(){\n\t//粒子下标\n\t_index = floor(gl_FragCoord.y) * uDataSize.x + floor(gl_FragCoord.x);\n\n\t//如果超出限制则清空\n\tif(_index >= uCount){\n\t\toGs = oVs = oPs = vec4(0.5,0.5,0.5,1.0);\n\t\treturn;\n\t}\n\n\t//获取粒子\n\tp = getParticleOfIndex(_index);\n\n\t//运行逻辑\n\trun();\n\n\t//输出粒子数据\n\toPs = vec4(p.position,p.weight);\n\toVs = vec4(p.velocity,p.life);\n\toGs = vec4(p.gravity,1.0);\n\toCs = p.color;\n}\n")},,,,,,,,,,,,,,,,,,,function(t,e,n){var r=t.exports=function(t){r.lcg=t,n(140),DMID=1825,t.dmReact=function(e){var n=this,r=n._dmid=DMID;DMID++,this.$render=function(){var r=e;if("function"==typeof e)r=e.call(n);r._option=n._option||{},n.proxy(t.$render(r)),n._proxy.setAttribute("lcg-dom-message",!0),n.ids=n._proxy.ids},this.$render(),this.on=function(e,n){t.domEvent(this._proxy,e,n.bind(this))},this.remove=function(){try{this._proxy.parentNode.removeChild(this._proxy)}catch(t){}},this.css=function(e,i,a){if(null==e)return this._css;if(!this._css||a){if(this._css=new t.ICE(e,"dm-"+r,{dom:n._proxy,static:a?this.__funcID:null}),!this._css||!this._css.render)return;this._css.args(i),this.message("lcg-css-render",(function(){n._css.render()})),a?(n._css.render(),n._css.play()):(this._proxy.appendChild(this._css.styleDom),this._css.render(),this._css.play())}else this._css.extend(e,!0),this._css.args(i),this._css.render(),this._css.play();return this._css},this.scss=function(t,e){return this.css(t,e,!0)}}}},,function(t,e,n){var r,i=u(n(6)),a=u(n(12)),o=u(n(13));function u(t){return t&&t.__esModule?t:{default:t}}var s=n(5),l=(n(14),s.React),c=t.exports=s(r=function(){function t(){(0,a.default)(this,t)}return(0,o.default)(t,[{key:"init",value:function(t,e){var n=this,r={x:0,y:0,main:n};for(var a in t)r[a]=t[a];this.$dom((function(){return l.createElement("div",null)}));var o={"z-index":1,position:"fixed","user-select":"none",left:r.x+"px",top:r.y+"px",cursor:"default","background-color":"#333",border:"1px solid #000","border-radius":"3px",padding:"2px",width:"max-content","box-shadow":"inset 0px 0px 2px rgba(255,255,255,0.5)",">div":{color:"#eee","font-size":"14px",position:"relative",padding:"0px 5px","min-width":"70px",">div":{display:"none"},":hover":{"background-color":"#ddd",color:"#000",">div":{display:"block"}}}};for(var a in e){var u=s.$r(l.createElement("div",{class:"item"},a));"object"==(0,i.default)(e[a])?u.appendChild(c.new({main:r.main},e[a])):"function"==typeof e[a]&&(u.cb=e[a],u.onclick=function(){r.main.remove(),this.cb()}),n._proxy.appendChild(u)}r.main==n?(document.body.appendChild(n._proxy),n._proxy.oncontextmenu=function(t){t.preventDefault()},this.message("mousedown",(function(t){s.isChild(n._proxy,t.target)||n.remove()}))):(o.position="absolute",o.left="calc(100%)",o.top="-3px"),this.css(o)}}]),t}())||r},function(t,e,n){t.exports=n(171)},function(t,e,n){var r,i=n(34),a=(r=i)&&r.__esModule?r:{default:r};var o=n(173),u=n(174),s=(t.exports=function(t){var e=this;if(null==(t=t||{}).canvas||null==t.gl)var n=s(),r=n.gl,i=n.canvas;else r=t.gl,i=t.canvas;this.gl=r,this.canvas=i;var l=this.cfg={data_width:64,data_height:64,count:200},c=[{format:r.RGBA,internalFormat:r.RGBA32F,type:r.FLOAT,mag:r.NEAREST},{format:r.RGBA,internalFormat:r.RGBA32F,type:r.FLOAT,mag:r.NEAREST},{format:r.RGBA,internalFormat:r.RGBA32F,type:r.FLOAT,mag:r.NEAREST},{format:r.RGBA,internalFormat:r.RGBA32F,type:r.FLOAT,mag:r.NEAREST}],f=[r.COLOR_ATTACHMENT0,r.COLOR_ATTACHMENT1,r.COLOR_ATTACHMENT2,r.COLOR_ATTACHMENT3],d=[];d.push(twgl.createFramebufferInfo(r,c,l.data_width,l.data_height)),r.drawBuffers(f),d.push(twgl.createFramebufferInfo(r,c,l.data_width,l.data_height)),r.drawBuffers(f),fbiKey=0;this.getFrameBuffer=function(){return d[fbiKey]},r.bindTexture(r.TEXTURE_2D,null),this.createEffector=function(t){return new o(t,e)},this.createRenderer=function(t){return new u(t,e)},this.writeUniform=function(t){var e={uniforms:{},fbi:d[0==fbiKey?1:0]};for(var n in t)e[n]=t[n];var r=(0,a.default)({},e.uniforms);return r.uPs=e.fbi.attachments[0],r.uVs=e.fbi.attachments[1],r.uGs=e.fbi.attachments[2],r.uCs=e.fbi.attachments[3],r.uDataSize=[l.data_width,l.data_height],r.uRandSeed=Math.random(),r.uCount=l.count,r},this.run=function(t,n){var i={uniforms:{},width:l.data_width,height:l.data_height,count:l.count};for(var a in t)i[a]=t[a];l.count=i.count,fbiKey++,fbiKey>1&&(fbiKey=0),twgl.bindFramebufferInfo(r,d[fbiKey]),r.viewport(0,0,i.width,i.height);var o=e.writeUniform(i);twgl.setUniforms(n.pi,o),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),twgl.drawBufferInfo(r,n.bi)}},function(){var t=t=document.createElement("canvas"),e=twgl.getContext(t,{premultipliedAlpha:!1});return twgl.addExtensionsToContext(e),{canvas:t,gl:e}})},function(t,e,n){var r=n(74),i={},a=window.location.href.split("?")[1];if(a)for(var o in a=a.split("&")){var u=a[o].split("=");i[u[0]]=u[1]}null!=i.demo?axios.get("./demos/"+i.demo+".json").then((function(t){document.body.appendChild(r.new(t.data))})):document.body.appendChild(r.new())},function(t,e,n){t.exports=n(75)},function(t,e,n){var r,i=l(n(3)),a=l(n(4)),o=l(n(44)),u=l(n(12)),s=l(n(13));function l(t){return t&&t.__esModule?t:{default:t}}var c=n(5),f=n(14),d=c.React,p=n(148),h=n(155),m=n(7),v=n(163),g=n(172);window.lcg=c,t.exports=c(r=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(t){var e=this;this.$dom((function(){return d.createElement("div",null,d.createElement("div",{class:"left"},d.createElement("div",{class:"top",lid:"top"},d.createElement("div",{lid:"view"},d.createElement("canvas",{style:"display:none;",lid:"canvas"}))),d.createElement("div",{class:"bottom",lid:"map"})),d.createElement("div",{class:"right",lid:"attrs"}))})),e.ids.canvas.getContext("2d"),y(e.ids.top,"view-");var n=p.new();if(v.base(n),g.mapModule(n),t)try{n.load(t)}catch(t){console.error(t)}else if(localStorage.save)try{n.load(JSON.parse(localStorage.save))}catch(t){console.error(t)}var r=h.map.new(n);r.module.message("struct-change",(function(){x()})),e.ids.map.appendChild(r),e.ids.attrs.appendChild(r.attrsDom),window.save=function(){var t=n.save(),e=(0,o.default)(t,(function(t,e){return null!=e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)?null:e}));console.log(e),localStorage.save=e};var u,s=!1,l=!1,x=(u=(0,a.default)(i.default.mark((function t(){var r;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!s){t.next=3;break}return l=!0,t.abrupt("return");case 3:return t.prev=3,t.next=6,n.run();case 6:if(!(r=t.sent).image){t.next=14;break}return t.next=10,m.getImage(r.image,"canvas",{canvas:e.ids.canvas});case 10:r=t.sent,e.ids.canvas.style.display="",e.ids.canvas.style.left=-e.ids.canvas.width/2+"px",e.ids.canvas.style.top=-e.ids.canvas.height/2+"px";case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(3),console.error(t.t0);case 19:s=!1,l&&(l=!1,x());case 21:case"end":return t.stop()}}),t,this,[[3,16]])}))),function(){return u.apply(this,arguments)});x(),this.message("dt",(function(){})),window.onkeydown=function(){x()};var b=new f({scale:1});b.$listen((function(){e.ids.view.style.transform="scale3d("+b.scale+","+b.scale+",1)"})),c.domEvent(e.ids.top,"mousewheel",(function(t){t.deltaY<0&&(b.scale*=1.1),t.deltaY>0&&(b.scale/=1.1)})),this.on("dragover",(function(t){t.preventDefault()})),this.on("drop",(function(t){t.preventDefault();for(var e=event.dataTransfer.files,i=0;i<e.length;i++)if("image"==e[i].type.substr(0,5)){var a=r.module.mouse2view(t);n.addNode("image-file-select",{x:a.x,y:a.y,forms:{file:e[i]}})}})),this.css({height:"100%",width:"100%","background-color":"#444",">div":{display:"inline-block",height:"100%","vertical-align":"top",".left":{width:"calc(100% - 850px)",">div":{".top":{height:"50%",overflow:"hidden",position:"relative",">div":{position:"absolute",left:"50%",top:"50%",">canvas":{position:"absolute",border:"1px solid #777"}}},".bottom":{height:"50%","border-top":"1px solid #555"}}},".right":{width:"850px","border-left":"1px solid #555"}}})}}]),t}())||r;var y=function(t,e){c.domEvent(t,"click",(function(t){c.triggerDom(e+"click",t)})),c.domEvent(t,"mousedown",(function(t){c.triggerDom(e+"mousedown",t)})),c.domEvent(t,"mousemove",(function(t){c.triggerDom(e+"mousemove",t)})),c.domEvent(t,"mouseup",(function(t){c.triggerDom(e+"mouseup",t)}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){var n=[],r=function(t,e,r){r=r||{},this.__func=t,this.__class=r.class||t,n.indexOf(t)<0&&n.push(t),this.__funcID=this.__classID=n.indexOf(t),this._option=r,this._vals=e,this.__auto_render=t.auto_render,this._option.proxy&&this.proxy(this._option.proxy,!0),this._option.extends=this._option.extends||[];var a=[""];for(var o in e)a.push(e[o]);for(var o in this._option.extends)a[0]=this._option.extends[o],this.extend.apply(this,a);var u=(this._option.initTarget||t).apply(this,e);for(var o in this._option.extendsAfter=this._option.extendsAfter||[],i.Plugins.module)i.Plugins.module[o][0]!=t&&"*"!=i.Plugins.module[o][0]||this._option.extendsAfter.push(i.Plugins.module[o][1]);for(var o in this._option.extendsAfter)a[0]=this._option.extendsAfter[o],this.extend.apply(this,a);return null==this._proxy&&this.proxy(this),this.sendMessage("module-ready"),u||this._proxy};r.prototype={proxy:function(t,e){return null==t||null!=this._proxy&&!e||(this._proxy=t,t.$=t.module=t.lModule=this),this._proxy},extend:function(t){if("dom-module"==t&&(t=i.dm),"function"==typeof t){n.indexOf(t)<0&&n.push(t);var e=this.__funcID;this.__funcID=n.indexOf(t);for(var r=[],a=1;a<arguments.length;a++)r.push(arguments[a]);var o=t.apply(this,r);return this.__funcID=e,o}console.error("["+t+"]不是一个组件!")},message:function(t,e){if("string"==typeof t)null==this._msgs&&(this._msgs={}),null==this._msgs[t]&&(this._msgs[t]=[]),this._msgs[t].push(e);else for(var n in t)this.message(n,t[n])},sendMessage:function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);for(var n in null==this._msgs&&(this._msgs={}),this._msgs[t])try{this._msgs[t][n].apply(this,e)}catch(t){console.error(t)}for(var n in e.splice(0,0,t),this._msgs["*"])try{this._msgs["*"][n].apply(this,e)}catch(t){console.error(t)}},triggerHook:function(t){for(var e=this.__func.__hook||{},n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);for(var r in null==n[0]&&(n[0]={}),e)if("*"==t||t==r||"*"==r)for(var i in e[r])"*"==r?e[r][i].apply(this,arguments):e[r][i].apply(this,n);if(n[0]&&n[0].returnValue)return n[0].returnValue},$dom:function(t){this.extend(i.dm,t)},$doms:function(t){this.extend(i.dmReact,t)}};var i=function(t){return"function"==typeof t?a(t):function(e){return a(e,t)}},a=i.bindClass=function(t,e){var n={extend:null,auto_render:!1};for(var a in e)n[a]=e[a];for(var a in r.prototype)null==t.prototype[a]&&(t.prototype[a]=r.prototype[a]);var o=function e(){for(var i=[],a=0;a<arguments.length;a++)i.push(arguments[a]);var o=e.__option||{};for(var a in delete e.__option,o.extendsAfter=o.extendsAfter||[],n.extend)o.extendsAfter.push(n.extend[a]);o.initTarget=t.prototype.init||function(){},o.class=t;var u=arguments[0],s=arguments[1],l=arguments[2],c=arguments[3],f=arguments[4],d=arguments[5],p=arguments[6],h=arguments[7],m=arguments[8],v=arguments[9],g=arguments[10],y=arguments[11],x=arguments[12],b=arguments[13],_=arguments[14],w=arguments[15],k=arguments[16],$=arguments[17],E=arguments[18];if(this==e){var S=new t(u,s,l,c,f,d,p,h,m,v,g,y,x,b,_,w,k,$,E);return S=r.call(S,e,i,o)}return o.initTarget.apply(this,arguments)};return o.new=function(){return o.apply(this,arguments)},o.option=function(t){return o.__option=t,o},o.hook=function(t,e){(o.__hook=o.__hook||{})[t]=o.__hook[t]||[],o.__hook[t].push(e)},o.plugin=function(t){i.Plugins.module.push([o,t])},o.auto_render=n.auto_render,o};i.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);return t.new.apply(t,e)},i.initAllFunction=function(){Function.prototype.new=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);var n=this.__option;return delete this.__option,new r(this,t,n)},Function.prototype.option=function(t){return this.__option=t,this},Function.prototype.hook=function(t,e){this.__hook=this.__hook||{},this.__hook[t]=this.__hook[t]||[],this.__hook[t].push(e)},Function.prototype.plugin=function(t){i.Plugins.module.push([this,t])}},i.bindFunc=i.bind=function(t,e){e=e||{};return t.new=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);var n=this.__option;return delete this.__option,new r(this,t,n)},t.option=function(t){return this.__option=t,this},t.hook=function(t,e){this.__hook=this.__hook||{},this.__hook[t]=this.__hook[t]||[],this.__hook[t].push(e)},t.plugin=function(e){i.Plugins.module.push([t,e])},t.auto_render=e.auto_render,t},i.proto=r.prototype,t.exports=i,i.config={def_scss:!1}},function(t,e,n){var r=s(n(105)),i=s(n(3)),a=s(n(4)),o=s(n(18)),u=s(n(6));function s(t){return t&&t.__esModule?t:{default:t}}t.exports=function(t){var e=t.cloneJSON=function(t){if(!t)return t;if([Number,String,Boolean].forEach((function(e){t instanceof e&&(n=e(t))})),void 0===n)if("[object Array]"===Object.prototype.toString.call(t))n=[],t.forEach((function(t,r,i){n[r]=e(t)}));else if("object"==(void 0===t?"undefined":(0,u.default)(t)))if(t.nodeType&&"function"==typeof t.cloneNode)var n=t.cloneNode(!0);else if(t.prototype)n=t;else if(t instanceof Date)n=new Date(t);else for(var r in n={},t)n[r]=e(t[r]);else n=t;return n},n=t.getDomOffset=function(t,e){if(null==t)return{x:0,y:0};if(t.offsetParent==e||t.offsetParent==document)return{x:t.offsetLeft,y:t.offsetTop};var r=n(t.offsetParent,e);return{x:r.x+t.offsetLeft,y:r.y+t.offsetTop}};t.getMouseOffset=function(t,e){var n=t.getBoundingClientRect();return{x:e.x-n.left,y:e.y-n.top}};t.isChild=function(t,e){for(var n=e;n&&n.parentNode&&n.parentNode!=document;){if(n==t||n.parentNode==t)return!0;n=n.parentNode}return!1},num=100,t.log=function(){num--,num<=0||console.log.apply(console,arguments)};t.UUID=function(t){t=t||4;for(var e=(new Date).getTime().toString(16),n=0;n<t;n++)e+="-"+(65536*(1+Math.random())|0).toString(16).substring(1);return e};t.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},t.delay=function(t){return new o.default((function(e){setTimeout((function(){e()}),t||1e3)}))},t.easySel=function(t,e,n){return e=e||"sel",t?e:n},t.dateFromat=function(t,e){var n={"Y+":t.getFullYear(),"y+":t.getFullYear(),"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return e},t.threadFunc=function(t,e,n){"function"==typeof e&&(n=e,e=null),e=e||5;for(var r=[],u=0;u<t.length;u++)r.push(t[u]);if(r.length<=0)return new o.default((function(t){t()}));var s,l,c=0,f=(s=(0,a.default)(i.default.mark((function t(){var e;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c++,e=r[0],r.splice(0,1),t.prev=3,t.next=6,n(e);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),console.error(t.t0);case 11:c--,d();case 13:case"end":return t.stop()}}),t,this,[[3,8]])}))),function(){return s.apply(this,arguments)}),d=function(){for(;;){if(r.length<=0)return l();if(c>=e)return;f()}};return setTimeout((function(){d()})),new o.default((function(t){l=t}))};var s=t.getLocalStorageKey=function(t){return window.location.host+"_"+t};t.setLocalStorage=function(t,e){var n=s(t);localStorage.setItem(n,e)},t.getLocalStorage=function(t){var e=s(t);return localStorage.getItem(e)},t.throttle=function(t,e){var n=Date.now();return function(){var i=this,a=arguments,o=Date.now();if(o-n>e){var u=(0,r.default)(a,2);u[0],u[1];t.apply(i,a),n=o}}}}},,,,,,,,,,,,,,,,,,,,function(t,e){t.exports=function(t){var e=t._events=t._events||{bind:[]};t.on=function(t,n){null==e[t]&&(e[t]=[]),e[t].push(n),"ready"==t&&1==a&&n()};var n=function(t,n){null==e[t]&&(e[t]=[]);var r=!1;(n=n||{}).$stop=function(){r=!0},n.$type=t;var i=e[t];for(var a in e[t]){i[a]||i.splice(a,1);var o=i[a](n);if(r)return o}};t.trigger=n;var r=[document];t.triggerDom=function(e,n,i,a){null==a&&(t.trigger("trigger-dom",{type:e,vals:n,target:i}),t.trigger("trigger-dom-"+e,{type:e,vals:n,target:i})),i=i||r,"[object Array]"!=Object.prototype.toString.call(i)&&(i=[i]),n=n||{};for(var o=0;o<i.length;o++){var u=i[o];u.module&&u.module.sendMessage(e,n);for(var s=u.querySelectorAll("*[lcg-dom-message]"),l=0;l<s.length;l++){var c=s[l];c.module&&c.module.sendMessage(e,n)}}},t.triggerDom.add=function(t){r.push(t)};var i,a=!1;t._ready=function(){a||(n("plugin-ready"),n("ready"),a=!0)},i=t._ready,document.addEventListener?document.addEventListener("DOMContentLoaded",(function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),i()}),!1):document.attachEvent&&document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),i())})),t.delayTime=20;!function e(){setTimeout(e,t.delayTime),n("dt"),t.triggerDom("dt")}(),t.domEvent=function(t,e,n){for(var r in"string"==typeof e&&(e=[e]),e)t.addEventListener?t.addEventListener(e[r],n,!1):t.attachEvent("on"+e[r],n)},t.domEvent(document,"mousemove",(function(e){t.wx=e.x,t.wy=e.y}))}},function(t,e,n){var r,i=n(6),a=(r=i)&&r.__esModule?r:{default:r};var o=n(126),u=n(127);t.exports=function(t){t.easycolor=o;var e={},n={ver:!1};window.CSS&&window.CSS.supports&&window.CSS.supports("--a",0),n.ver=!1,t.ICE=function(i,o,l){l=l||{};var d,p,h=this;if(this.option=l,this.key=o,l.dom&&null!=l.static){if(p=u.getJax(l.static),l.dom.setAttribute("ice-static-"+p.id,"true"),p.initEnd)return;o="static-"+p.id,d="ice-static-"+p.id,l.dom.setAttribute("ice-key",o)}else l.dom&&l.dom.setAttribute("ice-key",o);i=i||{},i=t.cloneJSON(i);var m=t.cloneJSON(i),v={},g={},y={},x=0;this.styleDom=document.createElement("style"),this.styleDom.style.display="none",this.styleDom.$$noRender=!0;var b=0;this.render=function(){if(!p||p.needRender(i,x)){var t="",n={},r={};for(var a in _(v,r),_(e,r),b=0,w(i,n,d?"["+d+"='true']":o?"[ice-key='"+o+"']":"",r),g)t+=o?"@keyframes "+o+"-"+a+"-"+x+"{"+g[a]+"}\n":"@keyframes "+a+"{"+g[a]+"}\n";for(var a in n)t+=a+"{"+n[a]+"}\n";return this.styleDom.innerHTML=t,p&&p.render(t),t}};var _=function(t,e){for(var n in t)null==e[n.length]&&(e[n.length]={}),null==e[n.length][n]&&(e[n.length][n]=t[n])};this.args=function(t){for(var e in t)v[e]=t[e];if(n.ver&&l.dom)for(var e in v)l.dom.style.setProperty("--"+e,v[e]);return this},this.clear=function(){return i={},g={},y={},this},this.refDef=function(){return i=t.cloneJSON(m),y={},this},this.extend=function(t,e){r({$:t},i,e)},this.setDef=function(t){return m=t,this},this.setKey=function(t){return o=t,this},this.rePlay=function(){return x++,this.render(),this},this.play=function(t){if(null!=(t=t||"_def")&&null!=y)for(var e in g={},y[t])this.ani(e,y[t][e]);return this.rePlay(),this},this.ani=function(t,e){var n="";for(var r in e){for(var i in n+=r+" {",e[r])n+=i+":"+e[r][i]+";";n+="}"}return g[t]=n,this};var w=function e(i,u,l,d){var p="",m=b;b++;i=t.cloneJSON(i);var v={};for(var g in i)"function"==typeof i[g]&&(v[g]=i[g],i[g]=i[g]());i.$&&r(i);var _=t.cloneJSON(d);if(i.$args)for(var g in i.$args)_[g]=i.$args[g];for(var w=function(t){if((t=t.toString()).indexOf("@")>=0)for(var e=30;e>=0;e--)for(var n in _[e])t=t.replace(new RegExp("@"+n,"g"),_[e][n]);if(t.indexOf("[")>0)for(var e in c)for(;;){var r=new RegExp("("+e+")\\[(.*?)\\]"),i=t.match(r);if(null==i||""==i||0==i.length)break;t=t.replace(r,c[i[1]].apply(c,i[2].split(",")))}return t};;){var k=!0;for(var g in i)f[g]&&(k=!1,f[g]({val:i[g],key:g,cssKey:l,dom:i,re:u,rep:w,module:h,sid:m,args:_}),delete i[g]);if(k)break}for(var g in function(t){for(var e in t.$anis&&(y._def=y._def||{},s(t.$anis,y._def,!0),delete t.$anis),t)if("$anis"==e.substr(0,5)){var n=e.substr(6);y[n]=t[e],y[n]=y[n]||{},s(t[e],y[n],!0),delete t[e]}}(i),i)if("$"!=g[0])if(null==i[g]||"object"!=(0,a.default)(i[g]))if("ani"!=g)p+=g+":"+i[g]+";";else if(o){var $=i[g].split(" ");$[0]=$[0]+"-"+x,p+="animation:"+o+"-"+$.join(" ")+";"}else p+="animation:"+i[g]+";";else{var E=l+g;g.indexOf(",")>=0&&(E=l+g.replace(/,/g,","+l)),e(i[g],u,E,t.cloneJSON(_))}if(p.indexOf("@")>=0)for(g=30;g>=0;g--)for(var S in _[g])p=n.ver?p.replace(new RegExp("@"+S,"g"),"var(--"+S+")"):p.replace(new RegExp("@"+S,"g"),_[g][S]);if(p.indexOf("[")>0)for(var g in c)for(;;){var C=new RegExp("("+g+")\\[(.*?)\\]"),O=p.match(C);if(null==O||""==O||0==O.length)break;p=p.replace(C,c[O[1]].apply(c,O[2].split(",")))}for(var g in v)i[g]=v[g];u[l]=p}};var r=t.extendJSON=function(t,e,n){e=e||t;var r=t.$;for(var i in"[object Array]"!=Object.prototype.toString.call(t.$)&&(r=[r]),r)s(r[i],e,n);e.$&&delete e.$},i=function(t){return null!=t&&(t.constructor==Array||t.constructor==Object)},s=t.copyJSON=function(e,n,o){for(var u in e)"$"!=u&&(null!=n[u]&&"object"==(0,a.default)(n[u])&&"object"==(0,a.default)(e[u])&&i(e[u])&&i(n[u])?s(e[u],n[u],o):(null==n[u]||o)&&(i(e[u])?n[u]=t.cloneJSON(e[u]):n[u]=e[u]));null!=e&&e.$&&r(e,n,o)},l=t.ICE.Color=function(t){var e={},n=o(t);return e.val=function(){return n.toString()},e.l=function(t){return n.l+=Number(t),e},e.a=function(t){return n.a+=Number(t),e},e},c={o:function(t,e){return new l(t).a(e).val()},l:function(t,e){return new l(t).l(e).val()},h:function(t,e){var n=o(t);return n.v+=Number(e),n.toString()}};t.ICE.args=function(t){if(-1==t)return e={};for(var r in t)e[r]=t[r];if(n.ver)for(var r in e)document.documentElement.style.setProperty("--"+r,e[r]);return e};var f={};t.ICE.key=function(t,e){if("string"==typeof t){var n={};n[t]=e,t=n}for(var r in t)f[r]=t[r]},t.ICE.render=function(){t.ICE.Static.clear(),t.triggerDom("lcg-css-render")},t.ICE.easycolor=o,t.ICE.Static=u}},function(t,e,n){var r=a(n(45)),i=a(n(6));function a(t){return t&&t.__esModule?t:{default:t}}!function(){function e(t,e){return t.map((function(n,r){return t[r]+e[r]}))}function n(t,e){return t.map((function(t){return t*e}))}function a(t,e){return t.map((function(t){return t/e}))}function o(t){return new RegExp("^"+function t(e,n){if(n in S)return e;var r=e.replace(new RegExp(O.join("|"),"g"),(function(e){return e in S?S[e]:t(C[e].source,e)}));return S[n]=r,r}(E[t].source,t)+"$","i")}function u(t,e){return null==t?null:C[e].exec(t)}function s(t){return Math.min(255,Math.max(0,Number(t)))}function l(t){var e="string"==typeof t&&"%"===t[t.length-1]?t.slice(0,-1):t;return Math.min(100,Math.max(0,Number(e)))}function c(t){return"string"==typeof t&&(-1!==t.indexOf("deg")?t=t.slice(0,-3):-1!==t.indexOf("grad")?t=360*t.slice(0,-4)/400:-1!==t.indexOf("rad")?t=360*t.slice(0,-3)/2/Math.PI:-1!==t.indexOf("turn")&&(t=360*t.slice(0,-4))),Number(t)}function f(t){return s(parseInt(t,16))}function d(t){var e=Math.round(t).toString(16);return e.length<2?"0"+e:e}function p(t,e){return e=Number("1e"+e),Math.round(t*e)/e}function h(t,e){return p(100*t/255,e)}function m(t,e,n){var r=Math.max(Math.max(t,e),n),i=r-Math.min(Math.min(t,e),n);if(0===i)return 0;switch(r){case t:return(e-n)/i*60+(e>=n?0:360);case e:return(n-t)/i*60+120;case n:return(t-e)/i*60+240}}function v(t,e,n){t/=255,e/=255,n/=255;var r,i=Math.max(Math.max(t,e),n),a=Math.min(Math.min(t,e),n),o=i-a,u=i+a;return r=u/2,{h:m(t,e,n),s:100*(0===u||0===o?0:.5>=r?o/u:o/(2-u)),l:100*r}}function g(t,e,n){t/=255,e/=255,n/=255;var r=Math.max(Math.max(t,e),n),i=Math.min(Math.min(t,e),n);return{h:m(t,e,n),s:100*(0===r?0:1-i/r),v:100*r}}function y(t,e,n){return 0>n&&(n+=1),n>1&&(n-=1),1>6*n?t+(e-t)*n*6:1>2*n?e:2>3*n?t+(e-t)*(2/3-n)*6:t}function x(t,e,n){e/=100;var r=.5>=(n/=100)?n*(e+1):n+e-n*e,i=2*n-r;return{r:255*y(i,r,(t/=360)+1/3),g:255*y(i,r,t),b:255*y(i,r,t-1/3)}}function b(t,e,n){0>(t%=360)&&(t+=360),e/=100,n/=100;var r,i,a,o=Math.floor(t/60)%6,u=t/60-o,s=n*(1-e),l=n*(1-u*e),c=n*(1-(1-u)*e);switch(o){case 0:r=n,i=c,a=s;break;case 1:r=l,i=n,a=s;break;case 2:r=s,i=n,a=c;break;case 3:r=s,i=l,a=n;break;case 4:r=c,i=s,a=n;break;case 5:r=n,i=s,a=l}return{r:255*r,g:255*i,b:255*a}}function _(t,e){if(t instanceof _)return t.clone();if(!(this instanceof _))return new _(t,e);var n={};(e=e||{}).type in w&&(n.type=e.type),void 0!==e.percentage&&(n.percentage=Boolean(e.percentage));var r,a,o,d=!1;"string"==typeof t&&("transparent"===t?(a="transparent",t={r:0,g:0,b:0,a:0}):t in k?(a="keyword",t={r:(t=k[t]).slice(0,2),g:t.slice(2,4),b:t.slice(4,6)}):(o=u(t,"rgb"))?(a="rgb",t={r:o[1],g:o[2],b:o[3]}):(o=u(t,"rgbpercent"))?(a="rgb",d=!0,t={r:o[1],g:o[2],b:o[3]}):(o=u(t,"rgba"))?(a="rgb",t={r:o[1],g:o[2],b:o[3],a:o[4]}):(o=u(t,"rgbapercent"))?(a="rgb",d=!0,t={r:o[1],g:o[2],b:o[3],a:o[4]}):(o=u(t,"hex3"))?(a="hex",t={r:o[1]+o[1],g:o[2]+o[2],b:o[3]+o[3]}):(o=u(t,"hex6"))?(a="hex",t={r:o[1],g:o[2],b:o[3]}):(o=u(t,"hex4"))?(a="hex",t={r:o[1]+o[1],g:o[2]+o[2],b:o[3]+o[3],a:o[4]+o[4]}):(o=u(t,"hex8"))?(a="hex",t={r:o[1],g:o[2],b:o[3],a:o[4]}):(o=u(t,"hsl"))?(a="hsl",t={h:o[1],s:o[2],l:o[3]}):(o=u(t,"hsla"))?(a="hsl",t={h:o[1],s:o[2],l:o[3],a:o[4]}):(o=u(t,"hsv"))?(a="hsv",t={h:o[1],s:o[2],v:o[3]}):(o=u(t,"hsva"))&&(a="hsv",t={h:o[1],s:o[2],v:o[3],a:o[4]}));if(function(t){return"[object Array]"===Object.prototype.toString.apply(t)}(t)&&t.length>=3){var p=t;t="hsl"===(a=n.type?n.type:"rgb")?{h:p[0],s:p[1],l:p[2]}:"hsv"===a?{h:p[0],s:p[1],v:p[2]}:{r:p[0],g:p[1],b:p[2]},p.length>3&&(t.a=p[3])}void 0===a&&"object"==(void 0===t?"undefined":(0,i.default)(t))&&(u(t.r,"number")&&u(t.g,"number")&&u(t.b,"number")?a="rgb":u(t.r,"percent")&&u(t.g,"percent")&&u(t.b,"percent")?(a="rgb",d=!0):u(t.h,"hue")&&u(t.s,"unit")&&u(t.l,"unit")?a="hsl":u(t.h,"hue")&&u(t.s,"unit")&&u(t.v,"unit")&&(a="hsv")),"transparent"===a?r=t:"hex"===a||"keyword"===a?(r={r:f(t.r),g:f(t.g),b:f(t.b)},t.a&&(t.a=f(t.a)/255)):"rgb"===a?r=!0===d?{r:l(t.r)/100*255,g:l(t.g)/100*255,b:l(t.b)/100*255}:{r:s(t.r),g:s(t.g),b:s(t.b)}:"hsl"===a?r=x(c(t.h),l(t.s),l(t.l)):"hsv"===a&&(r=b(c(t.h),l(t.s),l(t.v))),void 0===r?r={r:0,g:0,b:0,a:1}:r.a=u(t.a,"unit")?function(t){return"%"===t[t.length-1]&&(t=l(t)/100),Math.min(1,Math.max(0,Number(t)))}(t.a):1,"rgb"!==a||n.type||(n.type="hex"),this._val=r,this._type=n.type||a||"hex",this._percentage=void 0===n.percentage?d:Boolean(n.percentage)}var w={transparent:!0,keyword:!0,hex:!0,rgb:!0,hsl:!0,hsv:!0},k={black:"000000",silver:"c0c0c0",grey:"808080",gray:"808080",white:"ffffff",maroon:"800000",red:"ff0000",purple:"800080",fuchsia:"ff00ff",green:"008000",lime:"00ff00",olive:"808000",yellow:"ffff00",navy:"000080",blue:"0000ff",teal:"008080",aqua:"00ffff",orange:"ffa500",aliceblue:"f0f8ff",antiquewhite:"faebd7",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",blanchedalmond:"ffe4c4",bisque:"ffe4c4",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgrey:"a9a9a9",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategrey:"2f4f4f",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgrey:"696969",dimgray:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgray:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategrey:"778899",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",limegreen:"32cd32",linen:"faf0e6",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",oldlace:"fdf5e6",olivedrab:"6b8e23",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",skyblue:"87ceeb",slateblue:"6a5acd",slategrey:"708090",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",whitesmoke:"f5f5f5",yellowgreen:"9acd32",rebeccapurple:"663399"},$=function(t){var e,n={};for(e in t)n[t[e]]=e;return n}(k),E={number:/(?:[-+]?(?:\d*\.)?\d+(?:e[-+]?\d+)?)/,percent:/(?:number%)/,angle:/(?:number(?:deg|grad|rad|turn))/,unit:/(?:number|percent)/,hue:/(?:number|angle)/,rgb:/rgb\(\s*(number)[,\s]+(number)[,\s]+(number)\s*\)/,rgbpercent:/rgb\(\s*(percent)[,\s]+(percent)[,\s]+(percent)\s*\)/,rgba:/rgba\(\s*(number)[,\s]+(number)[,\s]+(number)(?:[,\s]*\/[,\s]*|[,\s]+)(unit)\)/,rgbapercent:/rgba\(\s*(percent)[,\s]+(percent)[,\s]+(percent)(?:[,\s]*\/[,\s]*|[,\s]+)(unit)\)/,hsl:/hsl\(\s*(hue)[,\s]+(percent)[,\s]+(percent)\s*\)/,hsla:/hsla\(\s*(hue)[,\s]+(percent)[,\s]+(percent)(?:[,\s]*\/[,\s]*|[,\s]+)(unit)\s*\)/,hsv:/hs(?:v|b)\(\s*(hue)[,\s]+(percent)[,\s]+(percent)\s*\)/,hsva:/hs(?:v|b)a\(\s*(hue)[,\s]+(percent)[,\s]+(percent)(?:[,\s]*\/[,\s]*|[,\s]+)(unit)\s*\)/,hex1:/[0-9a-f]/,hex2:/[0-9a-f]{2}/,hex3:/#(hex1)(hex1)(hex1)/,hex4:/#(hex1)(hex1)(hex1)(hex1)/,hex6:/#(hex2)(hex2)(hex2)/,hex8:/#(hex2)(hex2)(hex2)(hex2)/},S={number:E.number.source,hex1:E.hex1.source,hex2:E.hex2.source},C={},O=["number","hex1","hex2","percent","angle","unit","hue"];for(key in E)C[key]=o(key);_.random=function(){return _({r:Math.floor(256*Math.random()),g:Math.floor(256*Math.random()),b:Math.floor(256*Math.random())})},_.interpolation=function(t,n,r){if(!(t instanceof _&&n instanceof _))throw new TypeError;if(!r)return[];var i=[t.clone()];if(1===r)return i;for(var o=a(function(t,e){return t.map((function(n,r){return t[r]-e[r]}))}(n.getValue(),t.getValue()),r-1),u=1;r-2>=u;u++)i.push(_(e(i[i.length-1].getValue(),o)));return i.push(n.clone()),i},_.interpolation2d=function(t,e,n,r,i,a){if(!(t instanceof _&&e instanceof _&&n instanceof _&&r instanceof _))throw new TypeError;if(!i||!a)return[];if(1===i&&1===a)return[[t.clone()]];if(1===a)return[_.interpolation(t,r,i)];if(1===i)return _.interpolation(t,r,a).map((function(t){return[t]}));var o=_.interpolation(t,n,a),u=_.interpolation(e,r,a);return o.map((function(t,e){return _.interpolation(o[e],u[e],i)}))},_.mixAlpha=function(t,r){var i=t.a,o=r.a,u=t.getValue(),s=r.getValue(),l=i+o-i*o,c=a(e(n(u,i),n(s,o*(1-i))),l);return _({r:c[0],g:c[1],b:c[2],a:l})},[{name:"red",key:"r"},{name:"r",key:"r"},{name:"green",key:"g"},{name:"g",key:"g"},{name:"blue",key:"b"},{name:"b",key:"b"}].forEach((function(t){(0,r.default)(_.prototype,t.name,{get:function(){return Math.round(this._val[t.key])},set:function(e){u(e,"number")?this._val[t.key]=s(e):u(e,"percent")?this._val[t.key]=l(e)/100*255:this._val[t.key]=0}})})),["hue","h"].forEach((function(t){(0,r.default)(_.prototype,t,{get:function(){var t=this._val;return p(m(t.r,t.g,t.b),3)},set:function(t){var e=this._val,n=v(e.r,e.g,e.b);u(t,"hue")?n.h=c(t):n.h=0,this._val=x(n.h,n.s,n.l),this._val.a=e.a}})})),[{name:"satarate",key:"s"},{name:"s",key:"s"},{name:"light",key:"l"},{name:"l",key:"l"}].forEach((function(t){(0,r.default)(_.prototype,t.name,{get:function(){var e=this._val;return p(v(e.r,e.g,e.b)[t.key],3)},set:function(e){var n=this._val,r=v(n.r,n.g,n.b);u(e,"unit")?r[t.key]=l(e):r[t.key]=0,this._val=x(r.h,r.s,r.l),this._val.a=n.a}})})),["bright","v"].forEach((function(t){(0,r.default)(_.prototype,t,{get:function(){var t=this._val;return p(g(t.r,t.g,t.b).v,3)},set:function(t){var e=this._val,n=g(e.r,e.g,e.b);u(t,"unit")?n.v=l(t):n.v=0,this._val=b(n.h,n.s,n.v),this._val.a=e.a}})})),["alpha","a"].forEach((function(t){(0,r.default)(_.prototype,t,{get:function(){return p(this._val.a,3)},set:function(t){u(t,"number")?this._val.a=s(t):u(t,"percent")?this._val.a=l(t)/100:this._val.a=1}})})),function(t,e){var n;for(n in e){if(!e.hasOwnProperty(n))return;t[n]=e[n]}}(_.prototype,{toString:function(t){var e=this._val,n=t in w&&t||this._type,r=this._percentage;if("transparent"===n){if(0===e.a)return"transparent";n="hex"}if("keyword"===n){var i=d(e.r)+d(e.g)+d(e.b);if(1===e.a&&i in $)return $[i];n="hex"}return"hex"!==t&&"hex"===n&&1!==e.a&&(n="rgb"),"rgb"===n?r?this.toRgbPercentString():this.toRgbString():"hsl"===n?this.toHslString():"hsv"===n?this.toHsvString():"hex"===n?this.toHexString():void 0},toRgbString:function(){return 1===this._val.a?"rgb("+this.r+","+this.g+","+this.b+")":"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"},toRgbPercentString:function(){var t=this._val;return 1===t.a?"rgb("+h(t.r,3)+"%,"+h(t.g,3)+"%,"+h(t.b,3)+"%)":"rgba("+h(t.r,3)+"%,"+h(t.g,3)+"%,"+h(t.b,3)+"%,"+this.a+")"},toHslString:function(){var t=this._val,e=v(t.r,t.g,t.b);return 1===t.a?"hsl("+p(e.h,3)+","+p(e.s,3)+"%,"+p(e.l,3)+"%)":"hsla("+p(e.h,3)+","+p(e.s,3)+"%,"+p(e.l,3)+"%,"+this.a+")"},toHsvString:function(){var t=this._val,e=g(t.r,t.g,t.b);return 1===t.a?"hsv("+p(e.h,3)+","+p(e.s,3)+"%,"+p(e.v,3)+"%)":"hsva("+p(e.h,3)+","+p(e.s,3)+"%,"+p(e.v,3)+"%,"+this.a+")"},toHexString:function(){var t=this._val;return 1===t.a?"#"+d(t.r)+d(t.g)+d(t.b):"#"+d(t.r)+d(t.g)+d(t.b)+d(255*t.a)},toKeyword:function(){var t=this._val,e=d(t.r)+d(t.g)+d(t.b);return e in $?$[e]:""},getValue:function(){var t=this._val;return[t.r,t.g,t.b,t.a]},grayed:function(){var t=this._val,e=.3*t.r+.58*t.g+.11*t.b;return _({r:e,g:e,b:e,a:t.a})},inverting:function(){var t=this._val;return _({r:255-t.r,g:255-t.g,b:255-t.b})},interpolation:function(t,e){return _.interpolation(this,t,e)},interpolation2d:function(t,e,n,r,i){return _.interpolation2d(this,t,e,n,r,i)},mixAlpha:function(t){return _.mixAlpha(this,t)},clone:function(){return _(this._val,{type:this._type,percentage:this._percentage})}}),t.exports?t.exports=_:window.easycolor=_}()},function(t,e,n){var r,i=n(44),a=(r=i)&&r.__esModule?r:{default:r};var o=t.exports={},u={};o.clear=function(){for(var t in u)u[t].clear()};var s=document.createElement("style");document.head.appendChild(s);o.getJax=function(t){return null==u[t]&&(u[t]=new l(t)),u[t]};var l=function(t){var e=this;this.id=t;var n="",r=null,i={};this.clear=function(){i={}},this.str=function(){return n},this.render=function(t,a){if(n!=t)return n=t,i[a||r]=n,function(){var t="";for(var e in u)t+=u[e].str()+"\n";s.innerHTML=t}(),e.initEnd=!0,!1},this.className="lcg-ice-class-key-"+t,this.initEnd=!1,lastAniKey=-1,this.needRender=function(t,n){var o="";try{o=(0,a.default)(t)}catch(t){}return i[o]&&lastAniKey>=n?(e.render(i[o],o),!1):(lastAniKey=n,r=o,!0)}}},function(t,e,n){var r,i=n(6),a=(r=i)&&r.__esModule?r:{default:r};var o=n(129);t.exports=function(t){var e=1926;t.dm=function(i){var a=this;i.$$typeof&&(i=t.render(i)),i.$$type&&(i=t.$r(i)),"function"==typeof i&&(this.$render=i,i=null,this.$r=this.render=function(){var e=a.$render();return t.$r(e,i)},i=this.$r());a=this;if(!this.__hasDomModule){this.__hasDomModule=!0;var u=a._dmid=e;for(var s in e++,this.proxy(i),this.extend(r),a.attr(this._option.prefabAttr),this.attr({"lcg-dom-message":!0}),this._proxy._vueData){var l={data:this._proxy._vueData||{}};l.el=l.el||this._proxy,this._vue=new o(l);break}this._proxy.ids=this.ids={}||this._proxy.ids,this._proxy.message=a.message.bind(a),a.for((function(t){if(t.getAttribute("dom-slot")&&a._option.prefabDom){var e=a._option.prefabDom.childNodes,r=[];for(a._option.prefabDom._childNodes=r;e.length>0;)r.push(e[0]),t.appendChild(e[0])}if(t._prefab){var i=t.getAttribute("lid");return i&&null==a.ids[i]&&(a.ids[i]=t),t._prefab}var o=n(t).attr("lid");o&&null==a.ids[o]&&(a.ids[o]=t)}));var c=!1;return this.csss=this.css=function(e,n,r){if(null==e)return this._css;if(!this._css||r){if(this._css=this._css||new t.ICE(e,"dm-"+u,{dom:a._proxy,static:r?this.__funcID:null}),!this._css||!this._css.render)return;this._css.args(n),0==c&&this.message("lcg-css-render",(function(){a._css.render()})),r?(this._css.extend(e,!0),0==c&&this.message("module-ready",(function(){a._css.render(),a._css.play()}))):(this._proxy.appendChild(this._css.styleDom),this._css.render(),this._css.play()),c=!0}else this._css.extend(e,!0),this._css.args(n),this._css.render(),this._css.play();return this._css},this.scss=function(t,e){return this.csss(t,e,!0)},t.config.def_scss&&(this.css=this.scss,this.scss=this.csss),this._vue}};var n=t.$=function(t){return r.new(t)},r=t.dm.domFac=function(e){e=e||this._proxy,this.for=function(t){n(t,e)};var n=function t(e,n){if("#text"!=n.nodeName){var r=e(n);if(0!=r){if(null!=r)return t(e,r);for(var i=n._childNodes||n.childNodes,a=0;a<i.length;a++)t(e,i[a])}}};this.attr=function(t,n){var i=r();if(null==t&&null==n)return i;if("string"==typeof t&&"undefined"==String(n))return i[t];if("string"==typeof t)return"function"!=typeof n?e.setAttribute(t,n):e[t]=n;for(var o in t)null==t[o]||"function"!=typeof t[o]&&"object"!=(0,a.default)(t[o])?e.setAttribute(o,t[o]):e[o]=t[o]};var r=function(){for(var t={},n=e.attributes,r=0;r<n.length;r++)t[n[r].name]=n[r].value;return t};this.addClass=function(t){e.classList.add(t)},this.removeClass=function(t){e.classList.remove(t)},this.style=function(t,n){var r=i();if(null==t&&null==n)return r;if("string"==typeof t&&"undefined"==String(n))return r[t];if("string"==typeof t)return e.style[t]=n;for(var a in t)e.style[a]=t[a]};var i=function(){return window.getComputedStyle(e,null)};this.on=function(e,n){t.domEvent(this._proxy,e,n.bind(this))},this.destory=this.remove=function(){var n=this;try{var r={delay:0,target:e};this.sendMessage&&this.sendMessage("destory",r),t.triggerDom("destory",r,e),r.delay>0?setTimeout((function(){n._proxy.parentNode.removeChild(n._proxy)}),r.delay):this._proxy.parentNode.removeChild(this._proxy)}catch(r){console.error(r)}}};r=t.bindFunc(r)}},function(t,e,n){var r,i,a,o,u,s,l,c,f,d,p,m,v,g,y,x,b,_,w,k,$=C(n(45)),E=C(n(44)),S=C(n(6));function C(t){return t&&t.__esModule?t:{default:t}}i=function(t,e,n){if("string"==(e=void 0===t?"undefined":(0,S.default)(t)))return 1;if("boolean"==e)return 2;if("number"==e)return 3;if(t instanceof Array)return 4;if("object"==e)for(n in t)return 5;return"{}"==(0,E.default)(t)?5:0},a=function(t,e,n){for(n=e.length;n--&&t!=e[n];);return n},o=function(t,e,n,r,i,a){for(r=[],i=t.length,a=0,!n&&(n=i);e<n;)r[a]=t[e],e++,a++;return r},u=function(t,e,n,r,i,a,o,u){for(r=t.length,i=0,a="",o=".",n!=u&&(r=n);i<r;)i==r-1&&(o=""),a+=e?t[i]:t[i]+o,i++;return a},s={$_a:1,$_b:1,$_c:1,$_d:1,$_e:1,$_f:1,$_g:1,$_h:1,$_i:1,$_j:1,$_k:1,$_l:1,$_m:1,$_n:1,$_o:1,$_p:1},l=function t(e,n,r,i,a,o,u,l){for(u in n)(l=n[u])instanceof Array?(e[u]=[],c(e[u],l,r,i,a,o)):s[u]||(e[u]={},t(e[u],l,r,i,a,o))},c=function(t,e,n,r,i,a,o,u,c,f,d){for(o=e.length;o--;){if(c=e[o],t[o]={},t[o].$_a=c.$_a,t[o].$_b=c.$_b,t[o].$_d=n[c.$_c],t[o].$_h=n[c.$_i],t[o].$_e=n[c.$_g],t[o].$_f=c.$_f,t[o].$_j=n[c.$_k],t[o].$_l=n[c.$_m],c.$_p)for(u=(f=c.$_p).length;u--;)(d=n[c.$_o]).$_items=a,d.$_cache=a.$_cache,d.$_gData=a.$_gData,i.push(d),d[f[u][0]]=r[f[u][1]];for(u in c)s[u]||(t[u]={},l(t[u],c,n))}},f=function t(e,n,r,i,a,o,u,s,l){if(s=0,l=0,n||(n={},r=[]),a=e.nodeName,n.a={},n.a.a=a,n.a.b=function(t,e,n,r){if(t){if(n=[],e=t.length){for(;e--;)r=t[e].name,p[3].test(r)||n.push([t[e].name,t[e].value]);return n}return 0}}(e.attributes),r.push(e),i=e.childNodes){for(a=i.length,n.b=[];l<a;)1===(o=i[l].nodeType)&&(n.b[s]={},t(i[l],n.b[s],r),s++),3===o&&(u=i[l].textContent.trim())&&(u=u.replace(p[1],""),n.b[s]=u,s++,r.push(i[l])),l++;return[n,r]}},d=function t(e,n,r,a,o,u,s,l){if(u=e.b,o=e.a.a,s=document.createElement(o),o=e.a.b)for(l=o.length;l--;)s.setAttribute(o[l][0],o[l][1]);if(a?n.appendChild(s):r=[],r.push(s),u){for(l=u.length,a=0;a<l;)o=u[a],1==i(o)?(e=document.createTextNode(o),r.push(e),s.appendChild(e)):t(o,s,r,1),a++;return[s,r]}},p=[/(\{\{[^{}]+\}\})/,/(\{\{[^{}]+\}\})/g,/({{|}})/g,/^(e\-)/,/(\>\=|\<\=|\>|\<|\=\=\=|\=\=|\=)/],m={"=":0,"==":0,"===":0,">=":1,"<=":2,">":3,"<":4},v=function(t){var e=function(t){for(var e,n,r,i,a,o=[],u=t.length,s=0,l="",c=1;s<u;)if(e=t[s],c&&"="==e)o.push(l),o.push(e),l="",c=0,n=1,s++;else if(n&&"?"==e){for(i=(l=l.split(p[4])).length,a=0;a<i;)o.push(l[a]),a++;l="",n=0,o.push(e),r=1,i=++s}else{if(r&&")"==e&&":"==t[s+1]){o.push(t.slice(i+1,s)),o.push(":"),o.push(t.slice(s+3,-1));break}l+=e,++s==u&&o.push(l)}return o}(t),n=e.length,r=0,i=[];if(n>2){for(n=e.length,i.push(e[2].replace(p[2],"").trim()),9==n&&i.push(m[e[3]]);r<n;)r%2||2==r||i.push(e[r].trim()),r++;return i}},g=function(t,e,n,r,i){if((r=t.getAttribute(b[3]))&&(r=r.trim(),t.removeAttribute(b[3]),r&&(r=function(t,e,n,r,i){for(r=[],n=(e=t.split(";")).length;n--;)(i=v(e[n]))&&r.push(i);if(r.length)return r}(r))))for(i=r.length;i--;)e[r[i][0]]||(e[r[i][0]]=[]),e[r[i][0]].push({$_e:n?null:t,$_g:n?a(t,n):null,$_f:o(r[i],0)})},y=function(t,e,n,r){return(r=t.getAttribute(b[2]))&&(r=r.trim(),t.removeAttribute(b[2]),r)?(e[r]||(e[r]=[]),e[r].push({$_h:n?null:t,$_i:n?a(t,n):null}),0):1},x={"e-input":"$_j","e-change":"$_l","e-event":"$_n",$_j:"$_k",$_l:"$_m",$_n:"$_o"},b=["e-id","e-base","e-html","e-attr","e-for","prototype"],_=function(t,e,n,r,i,o,u,s,l,c,f,d,p,h,m,v,g,y){for(d=(h=t.attributes).length;d--;)if(l=(s=h[d]).name,m=0,(f=x[l])&&(c=s.value.trim(),t.removeAttribute(l),c)){if("$_n"==f){if(1==r)continue;for(g=[],m=1,v=(y=c.split(";")).length;v--;)g[v]=y[v].split(":")}if(m&&n||!m)e[c]||(e[c]=[]),(p={})[f]=n?null:t,p[x[f]]=n?a(t,n):null,m&&(p.$_p=g),e[c].push(p);else for(t.$_data=i,t.$_cache=o.$_cache,t.$_gData=o.$_gData,t.$_items=o,v=g.length;v--;)t[g[v][0]]=u[g[v][1]]}},w=function(t,e){return(e=document.createElement("div")).innerHTML=t.trim(),(e=e.childNodes)[0]},(k=function t(e,n,r,a,o,u,s){return(n=this).p=1,n.q=-1,n.r={},n.s=[],n.t=[0,1,2,3],n.u=[],n.v=e.cache||{},n.w=[[]],n.x=e.data||{},n.y=e.event||{},n.N=e.relate,n.a(),n.z={$_id:e.id,$_relate:[],$_ajax:n.P,$_require:t.g,$_newData:t.e,$_addData:n.Q,$_gData:n.x,$_caller:0,$_setToSelf:n.A,$_setToGlobal:n.B,$_watcher:n.C,$_event:n.y,$_watcherFor:n.D,$_cache:n.v},t.c(n.z),t.a.push(n.x,n,e.id),n.L=1,n.M(),n.E={},a=0,o=e.showStage,u=e.created,s=e.g,h=e.template,r=[],n.O={},n.O.a=u,n.O.b=1,n.O.c=1,h&&(a=1,n.z.$_el=w(h),n.c(n.z.$_el,n.r,"",0,n.x)),e.el&&(1==i(e.el)?(e.el=document.getElementById(e.el),a?s&&s.css||e.el.appendChild(n.z.$_el):(n.z.$_el=e.el,n.c(e.el,0,"",0,n.x))):a?(!s||!s.css)&&e.el.appendChild(n.z.$_el):(n.z.$_el=e.el,n.c(e.el,0,"",0,n.x))),e.watcher&&n.b(e.watcher,1),e.watcherFor&&n.b(e.watcherFor),n.x&&n.f(n.x,r,1),!e.x&&e.ajax&&(n.O.b=0,n.P(e.ajax,n.z)),r=null,n.L=0,s&&(s.css&&new t.g(s.css,0,(function(){e.el.appendChild(n.z.$_el),o&&o(n.z,n.v)})),s.js&&(n.O.c=0,new t.g(s.js,"js",(function(){n.O.c=1,n.O.b&&u&&u(n.z,n.v)})))),n.O.c&&n.O.b&&u&&u(n.z,n.v),n.x}).a=[],k.b=1,k.c=function(t,e){e=t.$_caller,Object.defineProperty(t,"$_caller",{set:function(t){k.b=(e=t)?0:1},get:function(){return e}})},k[b[5]].P=function(t,e){k.d(t,e)},k.init=function(t,e,n,r,i,a){for(e in a="$_sharedData",t)e!=a&&(n=window["$_"+e],r=t[e],n&&r&&n(r));(i=t[a])&&k.f(i)},k.addStyle=function(t,e){t&&((e=document.createElement("style")).innerText=t,document.head.appendChild(e))},k.e=function(t){return JSON.parse((0,E.default)(t))},k.f=function(t,e,n,r){e={m:localStorage,a:{},b:{},c:function(){for(var t,e=this,n=[e.m.$_eng_cj_cache,e.m.$_eng_d_cache],r=2;r--;)if(t=n[r])try{t=JSON.parse(t),r?e.b=t:e.a=t}catch(t){}},d:function(){var t=this;t.m.$_eng_cj_cache=(0,E.default)(t.a),t.m.$_eng_d_cache=(0,E.default)(t.b)},e:function(){this.a={},this.b={}},f:function(t,e){return e?this.b[t]:this.a[t]},g:function(t,e,n){n?this.b[t]=e:this.a[t]=e}},n=function(t,n){if(t){var r,i,a,o,u,s,l=t.split("="),c=1,f=1;if(i=(r=l[0].split(".")).length,t=r[0],a=(s=k.a.indexOf(t))>0?k.a[s-1].z.$_gData:0){for(n||(i-=1);c<i;){if(!(a=a[r[c]])){if(n){f=0;break}a[r[c]]={},a=a[r[c]]}c++}f&&(n?(e.b["$"+t]||(e.b["$"+t]={}),(o=e.b["$"+t])[l[0]]=a):(o=l[1].split(".")[0],(u=e.b["$"+o])&&(a[r[i]]=u[l[1]])))}}},r=function(r){var i,a,o,u,s,l,c=["<=>","=>","<?>","?>"],f=4;for(r||(c[1]="=",c[3]="?=",e.c());f--;)if(i=t[c[f]])for(i instanceof Array||(i=[i]),a=i.length;a--;)if(o=i[a],f<2&&(l=(s=k.a.indexOf(o))>0?k.a[s-1].z.$_gData:0),r)f>1?n(o,1):e.g(o,l,1);else if(f>1)n(o);else if((u=e.f(o,1))&&l)for(s in u)l[s]=u[s];r&&e.d()},e.e(),r(),window.addEventListener("focus",(function(){r()})),window.addEventListener("blur",(function(){e.e(),r(1)}))},k.d=function(t,e){var n,r,i,a,o,u,s,l,c=new XMLHttpRequest;n=(n=t.type||"get").toLowerCase(),r=(r=t.dataType||"json").toLowerCase(),i=t.url||"/eng-data",a=t.async||!0,o=t.data,l=(0,E.default)(o),c.open(n,i+("post"!=n&&o?"?"+l:""),a),c.setRequestHeader("Content-type","application/"+r),c.send("post"==n?l:""),c.onreadystatechange=function(){4==c.readyState&&(200==(s=c.status)||304==s?(u=c.responseText,t.success&&t.success("json"==r?JSON.parse(u):u,e)):t.error&&t.error(s,e))}},(k.g=function(t,e,n){var r,i=this,a=t instanceof Array,o=i.constructor;t&&(i.i=n,a?i.b=t:(i.b=[],i.b.push(t)),i.c=i.b.length,i.g=0,i.k=document.getElementsByTagName("head")[0],"js"==e?(i.l="script",i.o="text/javascript",i.m="type",i.n="src"):(i.l="link",i.o="stylesheet",i.m="rel",i.n="href"),o.a||(o.a=[]),i.e=o.a,(r=i.e).push(i),1==r.length&&i.p())})[b[5]].p=function(){var t,e=this;(t=document.createElement(e.l))[e.m]=e.o,t[e.n]=e.b[e.g],e.k.appendChild(t),t.onload=function(){e.g++,e.g==e.c&&e.i?(e.i(),e.e.splice(0,1),e.e[0]&&e.e[0].p()):e.p()},t.onerror=function(){e.g++,e.g!=e.c?e.p():(e.i(),e.e.splice(0,1),e.e[0]&&e.e[0].p())},t=0},k.h=function(){window.addEventListener("storage",(function(t){var e,n,r="$_eng_d_cache";t.key==r&&(e=t.newValue,(n=localStorage)[r]!=e&&(n[r]=e))}))},k.h(),k[b[5]].M=function(t,e,n,r,i,a,o,u,s){if(e=(t=this).N,r=k.a,e)for(i=e.length;i--;)n=e[i],(a=r.indexOf(n))>-1&&(e.splice(e.indexOf(n),1),e.length||(t.N=0),u=(o=t.z).$_id,s=r[a-1].z,o[n]=s,s[u]=o,(a=o.$_relate.indexOf(n))<0&&o.$_relate.push(n),(a=s.$_relate.indexOf(u))<0&&s.$_relate.push(u));if(t.L)for(i=r.length;i--;)(n=r[--i])!=t&&n.M(),i--},k[b[5]].a=function(){var t=this;t.A=function(e,n,r,a){return r={},a=1==i(n)?w(n):n,t.c(a,r,"",1),t.f(e,[],0,r,e),r=null,a},t.B=function(e,n,r,a,u,s,l,c,f,d){if(n=t.r,r=t.x,f=e.key,d=e.data,a=i(e.el),s=e.base?e.base.trim():"",1==a&&(e.el=w(e.el)),s){for(c=0,l=(u=s.split(".")).length;c<l;)n=n[u[c]],r=r[u[c]],c++;a=i(d),t.t[a]||(n[f]={},n=n[f],s+="."+f),u.push(f)}else u=[f],s=f,n[f]={},n=n[f];return r[f]=d,t.c(e.el,n,s,2,d),t.i(r,f,o(u,0),s,5),t.f(r[f],u,2),n=null,r=null,e.el},t.Q=function(e,n){n=[],t.x=e,t.z.$_gData=e,t.O.b=1,t.f(e,n,1),t.O.c&&t.O.a&&t.O.a(t.z,t.v),n=null},t.C=function(e){t.b(e,1)},t.D=function(e){t.b(e)}},k[b[5]].b=function(t,e,n,r,i){for(e in r=this,e?(r.F||(r.F={}),r=r.F):(r.G||(r.G={}),r=r.G),t)(n=t[e])!==i&&(r[e.trim()]=n)},k[b[5]].c=function(t,e,n,r,i,s,l,c,f,d,h,m,v,g,y,x,b,_,w){if(t&&(l=(s=t.childNodes).length,_=this,!e&&(n=(e=_.d(t,_.r,n,r,i))[1],i=e[2],e=e[0]),l))for(f=0,b=e;f<l;){if(3==(d=(t=s[f])?t.nodeType:-1)){if((v=(h=t.nodeValue.trim().split(p[1])).length)>1){for(w=o(h,0),g=0,y=[],x=[];g<v;)p[1].test(h[g])&&(y.push(g),m=h[g].replace(p[2],""),h[g]=m,w[g]="",x.push(m)),g++;for(t.nodeValue=u(w,1),v=x.length,g=0;g<v;)b[x[g]]||(b[x[g]]=[]),b[x[g]].push({$_d:_.H?null:t,$_c:_.H?a(t,_.I):null,$_a:y,$_b:h}),g++}}else 1==d&&(m=_.d(t,b,n,r,i),_.p&&_.c(t,m[0],m[1],r,m[2]));f++}},k[b[5]].d=function(t,e,n,r,i,o,u,s,l,c,d,p,h,m,v,x,w,k,$,E,S,C,O,M){if(u=1,c=1,(M=this).p=1,(o=t.getAttribute(b[1]))&&(o=o.trim(),t.removeAttribute(b[1]),o&&(M.H||(i=M.o(n.split("."),o,0,0,r))),n+=n?"."+o:o,e[o]={},e=e[o],u=0),r)g(t,e),M.p=y(t,e);else{if((o=t.getAttribute(b[4]))&&u&&(o=o.trim())){for(M.H=1,c=0,M.q++,M.w[M.q]=[],M.s[M.q]=[],n&&(M.w[M.q]=n.split(".")),m=function t(e,n,r,i,a,o,u,s,l,c,f,d){for(u=(o=e.childNodes).length,l=0,d=i.n,a&&(s=e.getAttribute(b[4]))&&(s=s.trim())&&(i.n++,r[s]={$_N:i.n,$_P:-1},f=r[s],n.push([s,f,e]),r=r[s],d=0);l<u;)1==o[l].nodeType&&(c=1,(s=o[l].getAttribute(b[4]))&&(s=s.trim())&&(i.n++,r[s]={$_N:i.n,$_P:d},f=r[s],n.push([s,f,o[l]]),t(o[l],n,f,i),c=0),c&&t(o[l],n,r,i)),l++}(t,p=[],d={},h={n:-1},1),s=p.length,l=0,O=M.w[M.q];l<s;){for(h={},S=[],C=[],$=l,E=0,v=p[l][1],x=p[l][0],k=p[l][2],w=v.$_N,0==l&&(v.e=k.parentNode,v.e.removeChild(k)),$++;$<s;)p[$][1].$_P==w&&(p[$][1].d=E,E++,C.push($)),$++;for($=E;$--;)(m=p[C[$]][2].parentNode).removeChild(p[C[$]][2]),S.push(m);for(d=f(k),M.I=d[1],g(k,h,M.I),M.p=y(k,h,M.I),M.p&&M.c(k,h,""),E&&(v.c=[]);E--;)v.c.push(a(S[E],M.I));v.b=d[0],v.a=h,O.push(x),l++}M.E[M.q]={},h=null,S=null,C=null,M.u[M.q]=p,p=null,M.H=0}M.H?(g(t,e,M.I),M.p=y(t,e,M.I)):(g(t,e),M.p=y(t,e))}return M.H?_(t,e,M.I,r,i,M.z,M.y,M.x):_(t,e,0,r,i,M.z,M.y,M.x),(o=t.getAttribute(b[0]))&&c&&!M.H&&(o=o.trim(),t.removeAttribute(b[0]),o&&(M.z[o]=t)),[e,n,i]},k[b[5]].e=function(t,e,n,r,i,a,s,c,f,p,h,m,v,g,y,x,b,_,w,k,$,E,S,C,O,M,A){if(n=function(t,e,n,r,i,a,u,s,l){for(r=e.length,s=[];r--;){for(n=e[r].length,i=0,a=0;i<n&&t[i]==e[r][i];)a++,i++;s[r]=a}for(n=s.length,a=-1,i=0;n--;)s[n]&&s[n]>i&&(i=s[n],a=n);if(-1!=a){for(i=0,n=(e=o(t,s[a]-1)).length,s=[],u=-1;i<n&&(r=e[i]);)e[i+1]!=l&&s.push(e[i+1]),u++,i+=2;return-1!=u?{a:u,b:a,c:s}:void 0}}(t,(e=this).w)){for(r=e.r,i=e.x,a=0,f=(s=t.length)-1,1==s&&(c=r);a<s;)r[t[a]]?r=r[t[a]]:(r[t[a]]={},r=r[t[a]]),i=i[t[a]],a==s-2&&(c=r),a++;if(s=i.length,p=n.a,h=n.b,-1!=e.w[h].indexOf(t[t.length-1])){if(g=n.c,y=(v=e.u[h][p][1]).a,x=v.b,b=v.c,m=v.d,p)for(s=p;s--;)(n=e.s[h][s])&&(g[s]=n.indexOf(Number(g[s])));if(S="$_"+h+p+(n=e.u[h][p][0])+u(g,1),e.G&&e.G[n])for(w=e.G[n],k=[],C=t.join(".")+"."+(g.length?g.join(".")+".":""),a=0,s=i.length;a<s;){if(A=null,w(_={$_allow:1,$_data:i[a],$_forData:i,$_index:a,$_watcher:function(t){A=t},$_pos:g.concat(a),$_gIndex:h,$_gData:e.x,$_gWatcher:e.C,$_items:e.z},e.v),A)for(E in A)O=C+a+"."+E,M=A[E],(n={})[O]=M,e.C(n);_.$_allow&&k.push(a),a++}for(e.s[h][p]=k,e.E[h][S]||(e.E[h][S]={a:[],b:[],c:[],d:[]}),$=e.E[h][S].a,E=e.E[h][S].b,w=e.E[h][S].c,M=e.E[h][S].d,_=e.E[h][S].e,e.E[h][S].e=[],c[t[f]]={},r=c[t[f]],p?(a=g.length,C="$_"+h+(p-1)+e.u[h][p-1][0]+u(g,1,a-1),n=e.E[h][C].c[g[a-1]][m],e.E[h][C].e.push([S,m])):n=v.e,t=b?b.length:0,g=1,a=0,(s=k?k.length:i.length)>=(h=E.length)&&(a=h),h>=s&&(g=0,a=s,s=h);a<s;){if(g){if(f=d(x),E.push(f[0]),t){for(c=t,p=[];c--;)p.push(f[1][b[c]]);w.push(p)}_={},m=[],M.push(m),l(_,y,f[1],e.y,m,e.z,e.x),$.push(_),n.appendChild(f[0])}else $.pop(),M.pop(),n.removeChild(E.pop()),w.pop();a++}for(s=k?k.length:$.length;s--;){for(c=(h=M[s]).length;c--;)h[c].$_data=i[k?k[s]:s];r[k?k[s]:s]=$[s]}return k}}},k[b[5]].f=function(t,e,n,r,a,s,l,c,f){var d,p,h,m,v,g=i(t),y=e,x=0,b=-1,_=this;for(d in t)p=t[d],m=null,v=0,s&&d!=s[x]||(l&&(c=++b,f=s?s[x]:x),n&&(g=i(p)),(e=o(y,0)).push(d),h=u(e),4==g&&1==n&&(m=_.e(e),v=1),n?_.i(t,d,o(e,0),h,g,c,f):_.j(e,r,a),_.t[g]||_.f(p,e,n,r,a,m,v,c,f),x++);y=null,e=null},k[b[5]].g=function(t,e,n,r,a){for(n in t)r=t[n],a=i(r),e&&void 0!==e[n]?t[n]=e[n]:a<4?t[n]="":5===a?this.g(r):t[n]=[]},k[b[5]].h=function(t,e,n,r){for(e in t)n=t[e],(r=i(n))>3?5===r?this.h(n):t[e]=[]:t[e]="",delete t[e]},k[b[5]].i=function(t,e,n,r,a,u,s,l,c,f,d,p,h,m,v){l=t[e],f=a,h=(c=this).z,k.b&&c.F&&c.F[r]&&(p=c.F[r],h.$_value=v,h.$_destroy=0,p(v,l,h,c.v),h.$_value==v||(l=h.$_value),h.$_destroy&&(p=null)),(0,$.default)(t,e,{enumerable:1,configurable:1,set:function(t){c.F&&c.F[r]!==v&&(p=c.F[r]),l!==t&&(f=i(t),k.b&&p&&(h.$_value=v,h.$_destroy=0,p(l,t,h,c.v),h.$_value===v||(t=h.$_value),h.$_destroy&&(p=null)),5==a?(5!=f&&(t="updata"==t?k.e(l):{}),c.g(l,t),c.f(l,n,1)):4==a?(4!=f&&(t="updata"==t?k.e(l):[]),d=o(n,0),c.h(l),l=t,c.f(l,d,1,0,0,c.e(d),1)):c.t[f]&&(l=t,c.j(n,0,0,u,s)),h.$_caller&&(h.$_caller=0))},get:function(){return l}}),c.t[f]&&c.j(n,0,0,u,s),h.$_caller&&(h.$_caller=0)},k[b[5]].j=function(t,e,n,r,i,a){(a=this.k(t,e,n,r,i))&&this.l(a,t,n)},k[b[5]].k=function(t,e,n,r,i){if(t){for(var a,o=t.length,u=this,s=0,l=e||u.r;s<o;){if(!l||!t)return;l=l[t[s]],s==o-2&&(a=l),s++}return l&&(l.$_index||l.$_value)&&(a=l),a&&(u.J=r,u.K=i,a.$_index&&u.l(a.$_index,t,n),a.$_value&&u.l(a.$_value,t,n)),l}},k[b[5]].l=function(t,e,n){for(var r,i,a=t.length,o=this;a--;)(r=t[a]).$_d&&(r.$_d.textContent=o.n(e,r.$_a,r.$_b,n)),r.$_e&&o.m(r.$_e,e,r.$_f,n),r.$_h&&(r.$_h.innerHTML=o.o(e,e[e.length-1],n)),r.$_j&&(i=o.o(e,e[e.length-1],n,1),r.$_j.value=i[0],r.$_j.oninput=function(){i[1][i[2]]=this.value}),r.$_l&&(i=o.o(e,e[e.length-1],n,1),r.$_l.value=i[0],r.$_l.onchange=function(){i[1][i[2]]=this.value})},k[b[5]].m=function(t,e,n,r){var i,a,o,u,s,l=this.o(e,n[0],r),c=n[1],f=n.length,d=1;2==f&&(u=1,d=0,a=l),4==f&&(l&&(u=1),d=0,a=n[2],o=n[3]),6==f&&(c=n[2],d=0,0==(i=n[1])&&l==n[3]&&(u=1),1==i&&l>=n[3]&&(u=1),2==i&&l<=n[3]&&(u=1),3==i&&l>n[3]&&(u=1),4==i&&l<n[3]&&(u=1),a=n[4],o=n[5]),d||(c&&(c=c.toLowerCase()),"class"==c&&(s=" "),"style"==c&&(s=";"),f>2&&s?((l=t.getAttribute(c))&&(l=l.replace(s+o,"").replace(s+a,"").trim()),l=l?l+s+(u?a:o):s+(u?a:o),t.setAttribute(c,l)):t.setAttribute(c,u?a:o))},k[b[5]].n=function(t,e,n,r,i,a,s,l){for(i=e.length,l=o(n,0);i--;)a=n[e[i]],s=this.o(t,a,r),l[e[i]]=s;return u(l,1)},k[b[5]].o=function(t,e,n,r,i,a,o,u,s,l){if(s=this,a=t.length,u=0,n=o=n||s.x,i&&a++,"$_index"==e)return s.J;for(;u<a&&(o=u!=a-1?o[t[u]]:o[e])!=l;)u==a-2&&(n=o),u++;return"$_value"==e?n[s.K]:(o==l&&(o=""),r?[o,n,e]:o)},r=k,t.exports=r},function(t,e){t.exports=function(t){t.Plugins={module:[]},t.plugin=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);null==t.Plugins[e]&&(t.Plugins[e]=[]),t.Plugins[e].push(n)}}},function(t,e,n){t.exports=function(t){var e,r;try{r=n(66),e=n(133)}catch(t){}var i=t.render=function(n,r){if("[object Array]"==Object.prototype.toString.call(n)){for(var i=[],a=0;a<n.length;a++)i.push(t.render(n[a]));return i}var o=n.type,u={};for(var a in n.props)"children"!=a&&(u[a]=n.props[a]);var s=n.props.children;"[object Array]"!=Object.prototype.toString.call(s)&&(s=[s]);if(null!=(u=u||{}).attrs&&"[object Object]"==Object.prototype.toString.call(u.attrs))for(var a in u.attrs)u[a]=u.attrs[a];var l="div";if("string"==typeof o&&(l=o),{svg:!0,rect:!0,circle:!0,ellipse:!0,line:!0,polyline:!0,polygon:!0,path:!0,defs:!0,filter:!0,lineargradient:!0,stop:!0,g:!0}[l]||"fe"==l.substr(0,2))var c=document.createElementNS("http://www.w3.org/2000/svg",l);else c=document.createElement(l);for(var a in u)"function"==typeof u[a]||c.setAttribute(a,u[a]),c[a]=u[a];var f={},d=function e(n){if("string"==typeof n||"number"==typeof n||null==n){if(null==n&&(n=""),(n+="").length>0){var r=document.createTextNode(n);c.appendChild(r)}}else if("[object Object]"==Object.prototype.toString.call(n))if(n.$$typeof){var i=t.render(n,c);c.appendChild(i)}else for(var a in n){r=document.createTextNode("{{"+a+"}}");c.appendChild(r),f[a]=n[a]}else if("[object Array]"==Object.prototype.toString.call(n))for(var a in n)e(n[a])};for(a=0;a<s.length;a++){d(l=s[a])}if(c._vueData=f,"string"!=typeof o){var p=!1;if(o.prototype&&o.prototype.isReactComponent)try{var h=document.createElement("div");c=e.render(n,h),c=h.childNodes[0],p=!0}catch(t){}if(!p){var m=c;(c=o.option({prefabDom:c,prefabAttr:u}).new(u))._prefab=m,(h=document.createElement("div")).appendChild(c)}}return c};t.createElement=function(){return"self"==t.reactMode?t.createRectElement.apply(t,arguments):r.createElement.apply(r,arguments)},t.createElementMain=function(){if("self"==t.reactMode)return t.createRectElement.apply(t,arguments);var e=t.createElement.apply(t,arguments),n=i(e);return n.$v=e,n}}},,,,,,function(t,e,n){var r,i=n(6),a=(r=i)&&r.__esModule?r:{default:r};t.exports=function(t){var e=t.$r=function(n,r,i,s,l){var c=!1;null==i&&(c=!0),i=i||{},l=l||{};var f,d={dom:!1,attr:!1,childs:!1};r&&(s=s||r.parentNode),"function"==typeof n.name&&null==n.name.new&&(n=n.name(n.attrs,n)),r&&(null==r.$$dom||"object"==(void 0===n?"undefined":(0,a.default)(n))&&("function"!=typeof n.name&&(r.tagName||"").toLowerCase()!=n.name.toLowerCase()||"function"==typeof n.name&&r.module&&r.module.__func!=n.name)||"object"!=(void 0===n?"undefined":(0,a.default)(n))&&"#text"!=r.nodeName||"object"==(void 0===n?"undefined":(0,a.default)(n))&&"#text"==r.nodeName)&&(d.dom=!0,f=r,r=null);var p=!1;if(null==r&&(r="object"!=(void 0===n?"undefined":(0,a.default)(n))?document.createTextNode(n):"function"!=typeof n.name?u(n.name):n.name.new(n.attrs),p=!0,null==r.module?r.$$mainNode=i.mainNode||r:r.$$parentNode=i.mainNode||r,r.$$dom={name:n.name,attrs:n.attrs},r.$$$dom={attrs:{}},s)){if(f)try{s.insertBefore(r,f),s.removeChild(f),t.triggerDom("destory",null,f)}catch(t){s.appendChild(r)}else s.appendChild(r);r.module&&r.module.sendMessage("did-mount")}null==i.mainNode&&(i.mainNode=r,r.ids=r.ids||{});var h={value:!0,checked:!0},m=function(t){d.attr=!0,c||(r.$$dom.attrs[t]=n.attrs[t]),r.$$$dom.attrs[t]=n.attrs[t],"function"!=typeof n.attrs[t]&&"object"!=n.attrs[t]?r.setAttribute(t,n.attrs[t]):r[t]=n.attrs[t],h[t]&&(r[t]=n.attrs[t]),"dom-slot"==t&&(i.mainNode.slotDom=r,i.mainNode.module&&(i.mainNode.module.slotDom=r),r.$$stopRender=!0,r.$$slotDom=!0),"lid"==t&&(i.mainNode.ids[n.attrs[t]]=r),"stop-render"==t&&(r.$$stopRender=!0)};for(var v in h)n.attrs&&void 0!==n.attrs[v]&&"input"==n.name&&n.attrs[v]!=r[v]&&m(v);for(var v in n.attrs)(n.attrs[v]!=r.$$dom.attrs[v]||p)&&m(v);if("function"!=typeof n.name||c)for(var v in r.$$dom.attrs)(n.attrs[v]!=r.$$dom.attrs[v]||c&&n.attrs[v]!=r.$$$dom.attrs[v])&&m(v),null==n.attrs[v]&&r.removeAttribute(v);for(var v in r.$$dom.attrs)void 0!==n.attrs[v]||c||(d.attr=!0,delete r.$$dom.attrs[v]);for(var v in function(){if(n.childs&&1!=r.$$stopRender&&(!n.attrs||null==n.attrs["render-once"]||p)){var a=r;if(a!=i.mainNode&&(a=r.slotDom||r),null==a.module||a==i.mainNode){var o=[];if(a.childNodes)for(var u=0;u<a.childNodes.length;u++)1!=a.childNodes[u].$$noRender&&o.push(a.childNodes[u]);var s=function(t){for(var e=n.childs,r=n.attrs["sort-key"]||"key",i=[],a={},o={},u=[],s={},l=[],c=!1,f=0;f<t.length;f++){var d=t[f];1!=d.$$noRender&&(null!=d.$$dom&&null!=d.$$dom.attrs&&null!=d.$$dom.attrs[r]?(null!=a[d.$$dom.attrs[r]]&&(c=!0,console.warn("键["+d.$$dom.attrs[r]+"]出现重复，可能导致DOM丢失")),o[d.$$dom.attrs[r]]=f,a[d.$$dom.attrs[r]]=d):u.push(d))}var p=0;for(var f in e)null==e[f].attrs||null==e[f].attrs[r]||null==a[e[f].attrs[r]]?u[p]&&u[p].$$dom&&u[p].$$dom.name==e[f].name?(i.push([e[f],u[p]]),s[p]=!0,p++):(i.push([e[f]]),c=!0):(o[e[f].attrs[r]]!=f&&(c=!0),i.push([e[f],a[e[f].attrs[r]]]),delete a[e[f].attrs[r]]);for(var f in u)null==s[f]&&l.push(u[f]);for(var f in a)l.push(a[f]);return{mitList:i,needSort:c,removes:l}}(o),l=s.mitList,c={};if(s.needSort){for(var u in l)null==l[u][1]?e(l[u][0],null,i,a,c):(e(l[u][0],l[u][1],i,a,c),a.appendChild(l[u][1]));for(u=a.childNodes.length-l.length-1;u>=0;u--){var f=a.childNodes[u];1!=f.$$noRender&&(a.removeChild(f),f.querySelectorAll&&t.triggerDom("destory",null,f))}}else{for(var u in l)null!=l[u][1]?e(l[u][0],l[u][1],i,a,c):e(l[u][0],null,i,a,c);for(var u in s.removes)a.removeChild(s.removes[u]),s.removes[u].querySelectorAll&&t.triggerDom("destory",null,s.removes[u])}c.change&&(d.childs=!0,1==a.$$slotDom&&a.$$mainNode&&a.$$mainNode.module&&a.$$mainNode.module.sendMessage("render-change-slot"))}}}(),"object"!=(void 0===n?"undefined":(0,a.default)(n))&&n.toString()!=r.data&&(r.data=n.toString()),n.attrs&&n.attrs["lcg-uses"]&&o(r,n.attrs["lcg-uses"]),d){var g=!1;d[v]&&(g=!0,r.module&&!c&&r.module.sendMessage("render-change-"+v,n)),g&&(r.module&&!c&&(r.module.sendMessage("render-change",n),r.module.$r&&r.module.__auto_render&&r.module.$r()),l.change=!0)}return r.module&&(p&&r.module.sendMessage("first-render-end"),r.module.sendMessage("render-end"),c||r.module.sendMessage("update-render-end")),r};t.React={createElement:function(t,e){if(null==t)throw new Error("无法使用空的标签名!");for(var n={$$type:"element",name:t,attrs:e||{}},r=[],i=2;i<arguments.length;i++){var a=arguments[i];if(null==a&&(a=""),"[object Array]"==Object.prototype.toString.call(a))for(var o=0;o<a.length;o++)null==a[o]&&(a[o]=""),r.push(a[o]);else r.push(a)}return n.childs=r,n}}};var o=function(t,e){if("function"==typeof e)return e(t);for(var n in e)"function"==typeof e[n]&&e[n](t)},u=function(t,e){return e=e||document,{svg:!0,rect:!0,circle:!0,ellipse:!0,line:!0,polyline:!0,polygon:!0,path:!0,defs:!0,filter:!0,lineargradient:!0,stop:!0,text:!0,g:!0}[t]||"fe"==t.substr(0,2)?e.createElementNS("http://www.w3.org/2000/svg",t):e.createElement(t)}},function(t,e,n){var r,i=n(6),a=(r=i)&&r.__esModule?r:{default:r};t.exports=function(t){var e=t.createRectElement=function(t,e){var n="http://www.w3.org/2000/svg",r={svg:!0,rect:!0,circle:!0,ellipse:!0,line:!0,polyline:!0,polygon:!0,path:!0,defs:!0,filter:!0,lineargradient:!0,stop:!0,g:!0};if(null!=(e=e||{}).attrs&&"[object Object]"==Object.prototype.toString.call(e.attrs))for(var i in e.attrs)e[i]=e.attrs[i];var o="div";if("string"==typeof t&&(o=t),r[o]||"fe"==o.substr(0,2))var u=document.createElementNS(n,o);else u=document.createElement(o);for(var i in e)"function"==typeof e[i]||(null==e[i]||"function"!=typeof e[i]&&"object"!=(0,a.default)(e[i]))&&u.setAttribute(i,e[i]),u[i]=e[i];var s={},l=function t(e){if("string"==typeof e||"number"==typeof e||null==e){null==e&&(e="");var n=document.createTextNode(e);u.appendChild(n)}else if("[object Object]"==Object.prototype.toString.call(e))for(var r in e){n=document.createTextNode("{{"+r+"}}");u.appendChild(n),s[r]=e[r]}else if("[object Array]"==Object.prototype.toString.call(e))for(var r in e)t(e[r]);else for(var r in u.appendChild(e),e._vueData)s[r]=e._vueData[r]};for(i=2;i<arguments.length;i++){l(o=arguments[i])}if(u._vueData=s,"string"!=typeof t){var c=u;(u=t.option({prefabDom:u,prefabAttr:e}).new(e))._prefab=c}return u};t.react={createElement:e},t.setReactMode=function(e){t.reactMode=e,"self"==e&&(window.React=t.react)}}},function(t,e){t.exports=function(t){var e=t.modify={};e.Write=function(t){return"function"==typeof t?t:function(e){for(var n in t)e[n]=t[n];return e}},e.Proto=function(t){return"function"==typeof t?t:function(e){for(var n in t)e.prototype[n]=t[n];return e}}}},function(t,e,n){var r,i=n(6),a=(r=i)&&r.__esModule?r:{default:r};var o=n(68).lcg;o.$react={createElement:function(t,e){for(var n={type:t,attrs:e=e||{},__ele:!0},r=[],i=2;i<arguments.length;i++)r.push(arguments[i]);return e._childs=r,n}},o.$render=function(t,e,n){var r=!1;null==n&&(r=!0,n={main:t},t.ids=t.ids||{});var i,u=t.attrs;if("string"==typeof t.type)i=document.createElement(t.type);else{for(var s in u._childs)u._childs[s]._info=n;i=t.type.option({childDom:u._childs}).new(u)}u.lid&&((t._info?t._info.main:n.main).ids[u.lid]=i);var l=function t(e){if("object"!=(void 0===(e=e||"")?"undefined":(0,a.default)(e))){var r=document.createTextNode(e);i.appendChild(r)}else if(e.__ele)i.appendChild(o.$render(e,null,n));else if("[object Array]"==Object.prototype.toString.call(e))for(var u in e)t(e[u]);else i.appendChild(e)};if(u._childs){var c=u._childs;if(delete u._childs,"string"==typeof t.type)for(var s in c)l(c[s])}if(u["dom-slot"]&&n.main._option){delete u["dom-slot"];c=n.main._option.childDom;for(var s in c)l(c[s])}for(var s in u)"function"==typeof u[s]||"object"==(0,a.default)(u[s])?i[s]=u[s]:i.setAttribute(s,u[s]);return r&&(i.ids=n.main.ids),i}},,,,,,,function(t,e,n){var r=n(14);r.Listen=function(t,e,n){"function"==typeof e&&(n=e,e=null),t.$listen(e,n),this.message("destory",(function(e){t.$unlisten(n)}))},r.DelayListen=function(t,e,n){var r;"function"==typeof e&&(n=e,e=null),t.$listen(e,(function(t){r=t})),this.message("dt",(function(){r&&(n(r),r=null)}))},r.ListenMgr=function(){var t=[];this.listen=function(e,n,r){"function"==typeof n&&(r=n,n=null),e.$listen(n,r),t.push({cam:e,func:r,key:n})},this.clear=function(){for(var e=t.length-1;e>=0;e--)t[e].cam.$unlisten(t[e].func),t.splice(e,1)},this.listenOne=function(){this.clear(),this.listen.apply(this,arguments)}},r.Text=function(t,e){var n={target:this,tree:!1,clos:null,action:function(t,e,n,r){r.target.ids[t]&&(r.target.ids[t].innerText=e)}};for(var i in e)n[i]=e[i];var a=new r(t,n.tree);for(var i in a.$listen((function(t){n.action(t.key,t.value,t,n)})),t)n.action(i,a[i],null,n);return a},r.List=function(t,e){var n=this,i={target:n._proxy,tree:!0,module:"div",strKey:null,action:function(t,e,n,r){"create"==t?r.actionCreate(e,n.index,n,r):"delete"==t?r.actionDelete(e,n.deletes,n,r):"sort"==t&&r.actionSort(n,r)},actionCreate:function(t,e,n,r){for(var i=o(),a=0;a<t.length;a++){var u=e+a,s=r.createItem(t[a],u,a,r.module,r);s.$__ListValue=t[a],u>=i.length?r.target.appendChild(s):r.target.insertBefore(s,i[u])}},actionDelete:function(t,e,n,r){for(var i=o(),a=[],u=[],s=0;s<t.length;s++)i[t[s]]&&(a.push(i[t[s]]),u.push(s));for(var s in a)r.deleteItem(a[s],u[s],s,r)},actionSort:function(t,e){for(var n=o(),r=0;r<u.length;r++)for(var i=0;i<n.length;i++){var a=n[i];if(a.$__ListValue==u[r]){e.target.appendChild(a);break}}},createItem:function(t,e,r,i,a){var o;return"function"!=typeof i?(o=document.createElement(i),null==a.strKey?o.innerText=t:o.innerText=t[a.strKey]):o=i.new(t,{index:e,sub_index:r,cfg:a,instance:n,parentNode:a.target,args:a.args,list:u}),o},deleteItem:function(t,e,n,r){t.module&&t.module.remove?t.module.remove():r.target.removeChild(t)}};for(var a in e)i[a]=e[a];var o=function(){for(var t=[],e=i.target.childNodes,n=0;n<e.length;n++)"STYLE"!=e[n].nodeName&&t.push(e[n]);return t},u=new r(t,i.tree),s=function(t){t.target==u&&i.action(t.action,t.value,t,i)};return u.$listen(s),this.message("destory",(function(){u.$unlisten(s)})),i.action("create",u,{index:0},i),u}},function(t,e,n){t.exports=n(149)},function(t,e,n){var r,i=l(n(3)),a=l(n(4)),o=l(n(34)),u=l(n(12)),s=l(n(13));function l(t){return t&&t.__esModule?t:{default:t}}var c=n(154),f=n(5),d=n(14);t.exports=f(r=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(){var t=this,e=this.nodes=new d([]),n=this.types={},r=this.modules={},u=(this.outputs=[{key:"image",type:"image",name:"屏幕"}],this.attrs={x:0,y:0,outputs:{}});this.addType=function(e){return null==e?console.warn("无法添加null作为数据类型"):null==e.key?console.warn("添加数据类型必须有key值"):n[e.key]?console.warn("添加数据类型失败，数据类型的key ["+e.key+"] 已存在"):(n[e.key]=e,void(e.selector&&t.addModule(h(e))))},this.addModule=function(t){return null==t?console.warn("无法添加null作为组件"):null==t.key?console.warn("添加组件必须有key值"):r[t.key]?console.warn("添加组件失败，组件的key ["+t.key+"] 已存在"):void(r[t.key]=t)},this.usePlugin=function(t){if(null!=t){for(var e in t.types)this.addType(t.types[e]);for(var e in t.modules)this.addModule(t.modules[e])}},this.addNode=function(n,i){if(null==r[n])return console.warn("没有找到["+n+"]组件");e.push(c.new(r[n],i,t))},this.removeNode=function(t){var n=t.attrs.uid;for(var r in e)e[r]!=t&&e[r].removeUidLink(n);for(var r in u.outputs)null!=u.outputs[r]&&u.outputs[r].uid==n&&delete u.outputs[r];e.remove(t)},this.save=function(){var t={attrs:u},n=t.nodes=[];for(var r in e){var i=(0,o.default)({},e[r].attrs);i.outputs&&delete i.outputs,n.push(i)}return t},this.load=function(e){for(var n in f.copyJSON(e.attrs,u,!0),e.nodes)t.addNode(e.nodes[n].key,e.nodes[n])},this.run=(0,a.default)(i.default.mark((function t(){var n,r,a,o;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in n={},e)e[r].attrs.level=-1,n[e[r].attrs.uid]=e[r],e[r].error=null;a=p(e,u.outputs,n),t.t0=i.default.keys(a);case 4:if((t.t1=t.t0()).done){t.next=10;break}return r=t.t1.value,t.next=8,a[r].run(n);case 8:t.next=4;break;case 10:o={},t.t2=i.default.keys(u.outputs);case 12:if((t.t3=t.t2()).done){t.next=19;break}if(r=t.t3.value,null!=u.outputs[r]){t.next=16;break}return t.abrupt("continue",12);case 16:n[u.outputs[r].uid]&&(o[r]=n[u.outputs[r].uid].attrs.outputs[u.outputs[r].key]),t.next=12;break;case 19:return t.abrupt("return",o);case 20:case"end":return t.stop()}}),t,this)})))}}]),t}())||r;var p=function(t,e,n){var r=function t(e,r){for(var i in r>e.attrs.level&&(e.attrs.level=r),e.attrs.inputs){var a=e.attrs.inputs[i];if(null!=a)if(f.isArray(a))for(var o in a)a[o].uid&&n[a[o].uid]&&t(n[a[o].uid],r+1);else a.uid&&n[a.uid]&&t(n[a.uid],r+1)}};for(var i in e)null!=e[i]&&null!=n[e[i].uid]&&r(n[e[i].uid],0);var a=[];for(var i in t)t[i].attrs.level>-1&&a.push(t[i]);return a.sort((function(t,e){return e.attrs.level-t.attrs.level})),a},h=function(t){return{name:"变量-"+t.name,menu:["变量",t.name],key:"$$type-vars-"+t.key,inputs:[{type:t.key,name:"值",key:"value",use_link:!1}],outputs:[{type:t.key,name:"输出",key:"value"}],run:(e=(0,a.default)(i.default.mark((function t(e){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{value:e.value});case 1:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})};var e}},,,,,function(t,e,n){var r,i=l(n(3)),a=l(n(18)),o=l(n(4)),u=l(n(12)),s=l(n(13));function l(t){return t&&t.__esModule?t:{default:t}}var c=n(5);t.exports=c(r=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(t,e,n){var r=this;this.info=t,this.error=null;var u,s=this.attrs={key:t.key,x:0,y:0,uid:c.UUID(),inputs:{},forms:{},level:0,outputs:{},cache:{}};for(var l in c.copyJSON(e,s,!0),t.inputs){var f=t.inputs[l];s.inputs[f.key]||(1==f.array?s.inputs[f.key]=[]:null!=f.default&&null==s.forms[f.key]&&(s.forms[f.key]=f.default))}t.init&&t.init.call(this),this.run=(u=(0,o.default)(i.default.mark((function e(n){var o,u,l,f,d;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(u in o={},s.forms)o[u]=s.forms[u];e.t0=i.default.keys(s.inputs);case 3:if((e.t1=e.t0()).done){e.next=11;break}if(u=e.t1.value,null!=(l=s.inputs[u])){e.next=8;break}return e.abrupt("continue",3);case 8:if(c.isArray(l))for(f in o[u]=[],l)o[u].push(n[l[f].uid].attrs.outputs[l[f].key]);else o[u]=n[l.uid].attrs.outputs[l.key];e.next=3;break;case 11:if(d={},e.prev=12,t.run&&(d=t.run.call(r,o)),!(d instanceof a.default)){e.next=18;break}return e.next=17,d;case 17:d=e.sent;case 18:d=d||{},e.next=25;break;case 21:throw e.prev=21,e.t2=e.catch(12),r.error=e.t2,e.t2;case 25:for(u in t.outputs)s.outputs[t.outputs[u].key]=d[t.outputs[u].key];return r.sendMessage("run-end",{outputs:s.outputs}),e.abrupt("return",d);case 28:case"end":return e.stop()}}),e,this,[[12,21]])}))),function(t){return u.apply(this,arguments)})}},{key:"addLink",value:function(t,e,n){var r=this.attrs.inputs;if(c.isArray(r[t])){for(var i in r[t])if(r[t][i].uid==e.attrs.uid&&r[t][i].key==n)return;r[t].push({uid:e.attrs.uid,key:n})}else r[t]={uid:e.attrs.uid,key:n}}},{key:"removeLink",value:function(t,e,n){var r=this.attrs.inputs;if(c.isArray(r[t]))for(var i in r[t])r[t][i].uid==e&&r[t][i].key==n&&r[t].splice(i,1);else r[t]=null}},{key:"removeUidLink",value:function(t){var e=this.attrs.inputs;for(var n in e)if(null!=e[n])if(c.isArray(e[n]))for(var r=e[n].length-1;r>=0;r--)e[n][r].uid==t&&e[n].splice(r,1);else e[n].uid==t&&(e[n]=null)}}]),t}())||r},function(t,e,n){(t.exports={}).map=n(156)},function(t,e,n){var r,i,a,o,u=l(n(12)),s=l(n(13));function l(t){return t&&t.__esModule?t:{default:t}}var c=n(5),f=n(14),d=c.React,p=n(157),h=n(158),m=n(159),v=n(160),g=n(70);t.exports=c(r=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(t){var e=this,n=this.store=new f(h(),!0);this.map=t,this.outputModules={};var r=this.modules={};this.$dom((function(){return d.createElement("div",null,d.createElement(v,{main:e}),d.createElement("div",{class:"bottom",lid:"bottom"},d.createElement("div",{class:"view",lid:"view"},d.createElement("svg",{lid:"svg"}),d.createElement("div",{lid:"modules"})),d.createElement("div",{class:"out"},d.createElement(x,{main:e}))))})),this.attrsDom=this._proxy.attrsDom=m.new(this),this.css({width:"100%",height:"100%","user-select":"none",">.bottom":{height:"calc(100% - 35px)",overflow:"hidden",position:"relative","font-size":"10px","background-color":"#222","background-image":"linear-gradient(#444 0%,#444 5%,rgba(0,0,0,0) 6%),linear-gradient(90deg,#444 0%,#444 5%,rgba(0,0,0,0) 6%)","background-size":"20px 20px",">.view":{position:"absolute",left:"50%",top:"50%",">svg":{width:"8000px",height:"8000px",position:"absolute",left:"-4000px",top:"-4000px",">g":{transform:"translate(4000px,4000px)"," path":{stroke:"#fff",fill:"transparent",cursor:"pointer"}}},">div":{position:"absolute",left:"0px",top:"0px"}},">.out":{position:"absolute",height:"100%",width:"100px",right:"0px",top:"0px","background-color":"#333","border-left":"1px solid #555"}}}),this.message("module-ready",(function(){e.ids.svg.appendChild(y.new({main:e}))})),w(this._proxy);var i=function(t){var n=p.new({node:t,main:e});r[t.attrs.uid]=n.module,e.ids.modules.appendChild(n)};for(var a in t.nodes)i(t.nodes[a]);t.nodes.$listen((function(t){if("create"==t.action)for(var n in t.value)i(t.value[n]);if("delete"==t.action)for(var n in t.deletes)a=t.deletes[n],r[a.attrs.uid].remove(),delete r[a.attrs.uid];var a;e.trigger("line-draw")})),this.on("contextmenu",(function(t){t.preventDefault()})),c.domEvent(e.ids.view,"mousewheel",(function(t){var r=n.states.scale;t.deltaY<0&&(r+=1),t.deltaY>0&&(r-=1),r<6&&(r=6),r>20&&(r=20),e.ids.bottom.style["font-size"]=r+"px",n.states.scale=r}));var o,u=function(){e.ids.view.style["margin-left"]=t.attrs.x+"px",e.ids.view.style["margin-top"]=t.attrs.y+"px"};u();var s,l,b,_,k,$,E={x:0,y:0};!function(){var e=t.modules,n={},r=function(e){for(var r=n,i=0;i<e.menu.length-1;i++)r[e.menu[i]]=r[e.menu[i]]||{},r=r[e.menu[i]];r[e.menu[i]]=function(){t.addNode(e.key,{x:E.x,y:E.y})}};for(var i in e)e[i].menu&&r(e[i]);o=n}(),k=!1,$=!1,e.on("mousedown",(function(n){2==n.button&&(n.target!=e.ids.bottom&&n.target!=e.ids.svg||($=!1,k=!0,s=t.attrs.x,l=t.attrs.y,b=n.x,_=n.y))})),e.message("mousemove",(function(n){k&&($=!0,t.attrs.x=s+n.x-b,t.attrs.y=l+n.y-_,u(),e.trigger("line-draw"))})),e.message("mouseup",(function(t){k&&(k=!1,$||(E=e.mouse2view(t),g.new(t,{"创建节点":o})))})),this.dom2view=function(t,n){return(n=n||{x:0,y:0}).x+=t.offsetLeft,n.y+=t.offsetTop,t.parentNode==e.ids.bottom||null==t.parentNode?(n.x-=e.ids.view.offsetLeft,n.y-=e.ids.view.offsetTop,n):e.dom2view(t.parentNode,n)},this.mouse2view=function(t){var n=e.ids.view.getBoundingClientRect();return{x:t.x-n.x,y:t.y-n.y}},this.trigger=function(t,n){c.triggerDom(t,n,e._proxy)}}}]),t}())||r;var y=c(i=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(t){var e=this;this.main=t.main;var n=[],r=t.main.map.nodes;this.$dom((function(){var i;if(null!=t.main.store.states.activeLine){var a=t.main.store.states.activeLine;i=e.getLine({x:a.x1,y:a.y1},{x:a.x2,y:a.y2})}for(var o in n=[],r)for(var u in r[o].attrs.inputs)if(c.isArray(r[o].attrs.inputs[u]))for(var s in r[o].attrs.inputs[u])n.push(e.getLineOfLink(r[o],r[o].attrs.inputs[u][s],u));else null!=r[o].attrs.inputs[u]&&n.push(e.getLineOfLink(r[o],r[o].attrs.inputs[u],u));for(var o in g_lines=[],t.main.map.attrs.outputs)null!=t.main.map.attrs.outputs[o]&&g_lines.push(e.getLineOfLinkGlobal(t.main.map.attrs.outputs[o],o));return d.createElement("g",null,d.createElement("g",null,i),d.createElement("g",null,n),d.createElement("g",null,g_lines))})),this.extend(f.Listen,t.main.store.states,(function(){e.$r()})),this.message("line-draw",(function(){e.$r()})),this.message("resize",(function(){e.$r()})),setTimeout((function(){e.$r()}))}},{key:"getLine",value:function(t,e,n){var r=(e.x+t.x)/2,i=(e.y+t.y)/2;return d.createElement("path",{data:n,oncontextmenu:this.delLink,d:"M"+t.x+","+t.y+" Q"+(t.x+40)+","+t.y+","+r+","+i+" T"+e.x+","+e.y})}},{key:"getLineOfLink",value:function(t,e,n){var r=this.main.modules[t.attrs.uid],i=this.main.modules[e.uid],a=this.main;return this.getLine(i.outputModules[e.key].getPluginPos(),r.inputModules[n].getPluginPos(),{node:t,link:e,inputkey:n,main:a})}},{key:"getLineOfLinkGlobal",value:function(t,e){var n=this.main.modules[t.uid].outputModules[t.key].getPluginPos(),r=this.main.outputModules[e].getPluginPos();return this.getLine(n,r,{node:this.main,main:this.main,inputkey:e,link:t})}},{key:"delLink",value:function(){var t=this.$$dom.attrs.data;null!=t&&(t.node==t.main?t.main.map.attrs.outputs[t.inputkey]=null:t.node.removeLink(t.inputkey,t.link.uid,t.link.key),t.main.trigger("line-draw"),t.main.trigger("struct-change"))}}]),t}())||i,x=c(a=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(t){for(var e in this.$dom((function(){return d.createElement("div",null)})),t.main.map.outputs){var n=t.main.map.outputs[e],r=b.new({data:n,main:t.main});this._proxy.appendChild(r),t.main.outputModules[n.key]=r.module}this.css({height:"100%",width:"100%"})}}]),t}())||a,b=c(o=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(t){var e=this;this.data=t.data,this.node=t.node,this.$dom((function(){return d.createElement("div",null,d.createElement("i",{lid:"plugin"}),d.createElement("z",null,t.data.name))})),this.extend(p.ItemStyle,t);this.extend(f.Listen,t.main.store.states,(function(){!t.main.store.states.activeOutputNode||t.main.store.states.activeOutputNode.data.type!=t.data.type&&"*"!=t.data.type?e.ids.plugin.classList.remove("active"):e.ids.plugin.classList.add("active")})),c.domEvent(e.ids.plugin,"mouseup",(function(e){var n=t.main.store.states.activeOutputNode;null==n||n.data.type!=t.data.type&&"*"!=t.data.type||(t.main.map.attrs.outputs[t.data.key]={uid:n.node.attrs.uid,key:n.data.key},t.main.trigger("struct-change"))}))}}]),t}())||o,_=!1,w=function(t){_||(_=!0,c.domEvent(document,"click",(function(t){c.triggerDom("click",t)})),c.domEvent(document,"mousedown",(function(t){c.triggerDom("mousedown",t)})),c.domEvent(document,"mousemove",(function(t){c.triggerDom("mousemove",t)})),c.domEvent(document,"mouseup",(function(t){c.triggerDom("mouseup",t)})),c.domEvent(window,"resize",(function(t){c.triggerDom("resize",t)})))}},function(t,e,n){var r,i,a,o=l(n(34)),u=l(n(12)),s=l(n(13));function l(t){return t&&t.__esModule?t:{default:t}}var c=n(5),f=c.React,d=n(14),p=n(70);t.exports=c(r=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(t){var e=this.node=t.node,n=e.info,r=this;for(var i in this.$dom((function(){return f.createElement("div",null,f.createElement("div",{lid:"title",class:"title"},n.name),f.createElement("div",{class:"group"},f.createElement("div",{lid:"left",class:"left"}),f.createElement("div",{lid:"right",class:"right"})))})),this.css({width:"20em",color:"#eee","border-radius":"4px","user-select":"none",border:"1px solid #666",position:"absolute",":hover":{"box-shadow":"0px 0px 3px rgba(255,255,255,0.5)"},".active":{"box-shadow":"0px 0px 3px 1px #ffb700"},".error":{"box-shadow":"0px 0px 3px 1px #f00"},">.title":{"background-color":"#444","border-radius":"4px 4px 0px 0px","text-align":"center",height:"1.4em","line-height":"1.4em",overflow:"hidden","border-bottom":"1px solid #555","font-size":"1.6em",cursor:"pointer"},">.group":{"background-color":"#333","border-radius":"0px 0px 4px 4px",position:"relative",">div":{display:"inline-block",width:"50%","text-align":"left","vertical-align":"top",position:"relative",".right":{"text-align":"right"}}}}),this.inputModules={},this.outputModules={},this.inputForms={},n.inputs)if(0!=n.inputs[i].use_link){var a=m.new((0,o.default)({data:n.inputs[i],key:i},t));this.inputModules[n.inputs[i].key]=a.module,r.ids.left.appendChild(a)}for(var i in n.outputs){a=v.new((0,o.default)({data:n.outputs[i],key:i},t));this.outputModules[n.outputs[i].key]=a.module,r.ids.right.appendChild(a)}var u,s,l,h,g,y,x=function(){r._proxy.style.left=e.attrs.x/10+"em",r._proxy.style.top=e.attrs.y/10+"em",t.main.store.states.activeNode==r?r._proxy.classList.add("active"):r._proxy.classList.remove("active")};x(),this.extend(d.Listen,t.main.store.states,(function(){x()})),e.message("change",(function(){t.main.trigger("struct-change")})),this.on("click",(function(){t.main.store.states.activeNode=r})),r.message("dt",(function(){e.error!=u&&(u=e.error,null==e.error?(r._proxy.classList.remove("error"),r._proxy.removeAttribute("title")):(r._proxy.classList.add("error"),r._proxy.setAttribute("title",e.error.stack)))})),y=!1,c.domEvent(r.ids.title,"mousedown",(function(t){y=!0,h=t.x,g=t.y,s=e.attrs.x,l=e.attrs.y})),r.message("mousemove",(function(n){y&&(e.attrs.x=s+10*(n.x-h)/t.main.store.states.scale,e.attrs.y=l+10*(n.y-g)/t.main.store.states.scale,x(),t.main.trigger("line-draw"))})),r.message("mouseup",(function(t){y&&(y=!1)})),this.on("contextmenu",(function(n){p.new(n,{"删除节点":function(){t.main.map.removeNode(e)}})}))}}]),t}())||r;var h=t.exports.ItemStyle=function(t){var e=this;this.css({overflow:"hidden",height:"1.8em","line-height":"1.8em",position:"relative",">z":{"font-size":"1.4em",display:"inline-block","vertical-align":"middle",color:"#eee"},">i":{display:"inline-block",width:"0.8em",height:"0.8em",border:"1px solid #fff","vertical-align":"middle","border-radius":"100%",margin:"0px 3px",cursor:"pointer",opacity:.3,position:"relative",":before":{content:"''",display:"inline-block",width:"60%",height:"60%","background-color":"#ffb700",top:"20%",left:"20%","border-radius":"100%",position:"absolute",opacity:0},":hover":{"box-shadow":"0px 0px 3px #fff",opacity:1},".active":{"box-shadow":"0px 0px 3px 1px #ffff00",opacity:1,":before":{opacity:1}}}}),this.getPluginPos=function(){var n=t.main.dom2view(e.ids.plugin);return n.x+=5,n.y+=5,n}},m=c(i=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(t){var e=this;this.data=t.data,this.node=t.node,this.$dom((function(){return f.createElement("div",null,f.createElement("i",{lid:"plugin"}),f.createElement("z",null,f.createElement("t",{lid:"before"}),t.data.name,f.createElement("t",{lid:"after"})))})),this.extend(h,t),t.main.map.types[t.data.type].inputUIExpand&&t.main.map.types[t.data.type].inputUIExpand(e);this.extend(d.Listen,t.main.store.states,(function(){!t.main.store.states.activeOutputNode||t.main.store.states.activeOutputNode.data.type!=t.data.type&&"*"!=t.main.store.states.activeOutputNode.data.type&&"*"!=t.data.type?e.ids.plugin.classList.remove("active"):e.ids.plugin.classList.add("active")})),c.domEvent(e.ids.plugin,"mouseup",(function(e){var n=t.main.store.states.activeOutputNode;null==n||n.data.type!=t.data.type&&"*"!=n.data.type&&"*"!=t.data.type||n.node==t.node||(t.node.addLink(t.data.key,n.node,n.data.key),t.main.trigger("line-draw"),t.main.trigger("struct-change"))}))}}]),t}())||i,v=c(a=function(){function t(){(0,u.default)(this,t)}return(0,s.default)(t,[{key:"init",value:function(t){var e,n,r=this;this.data=t.data,this.node=t.node,this.$dom((function(){return f.createElement("div",null,f.createElement("z",null,f.createElement("t",{lid:"before"}),t.data.name,f.createElement("t",{lid:"after"})),f.createElement("i",{lid:"plugin"}))})),this.extend(h,t),t.main.map.types[t.data.type]&&t.main.map.types[t.data.type].outputUIExpand&&t.main.map.types[t.data.type].outputUIExpand(r),n=!1,c.domEvent(r.ids.plugin,"mousedown",(function(i){n=!0,t.main.store.states.activeOutputNode=r,e=r.getPluginPos(),t.main.store.states.activeLine={x1:e.x,y1:e.y,x2:e.x,y2:e.y}})),r.message("mousemove",(function(r){if(n){var i=t.main.mouse2view(r);t.main.store.states.activeLine={x1:e.x,y1:e.y,x2:i.x,y2:i.y}}})),r.message("mouseup",(function(){n&&(n=!1,t.main.store.states.activeLine=null,t.main.store.states.activeOutputNode=null)}))}}]),t}())||a},function(t,e){t.exports=function(){return{states:{activeLine:null,activeOutputNode:null,activeNode:null,scale:10}}}},function(t,e,n){var r,i,a=u(n(12)),o=u(n(13));function u(t){return t&&t.__esModule?t:{default:t}}var s=n(5),l=n(14),c=s.React;t.exports=s(r=function(){function t(){(0,a.default)(this,t)}return(0,o.default)(t,[{key:"init",value:function(t){var e=this;this.$dom((function(){return c.createElement("div",null,c.createElement("div",{lid:"panle"}))}));var n;t.map.types;this.css({width:"100%",height:"100%","background-color":"#333"}),this.extend(l.Listen,t.store.states,"activeNode",(function(){if(null!=(n=t.store.states.activeNode)){var r=n.node.info;for(var i in r.inputs)if(null==n.inputForms[r.inputs[i].key]&&1!=r.inputs[i].array){var a=t.map.types[r.inputs[i].type];null!=a?null!=a.selector&&(n.inputForms[r.inputs[i].key]=f.new({node:n,node_info:r,info:r.inputs[i],type_info:a,main:t})):console.warn("没有找到参数类型["+r.inputs[i].type+"]")}for(var i in e.ids.panle.innerText="",n.inputForms)e.ids.panle.appendChild(n.inputForms[i])}}))}}]),t}())||r;var f=s(i=function(){function t(){(0,a.default)(this,t)}return(0,o.default)(t,[{key:"init",value:function(t){this.$dom((function(){return c.createElement("div",null,c.createElement("div",{class:"title"},t.info.name),c.createElement("div",{class:"panle",lid:"panle"}))})),this.css({margin:"0px 5px",padding:"5px 0px",">.title":{color:"#fff"},">.panle":{padding:"2px 5px"}});var e=t.node.node.attrs.forms[t.info.key]||t.info.default,n=t.type_info.selector(e,(function(e){t.node.node.attrs.forms[t.info.key]=e,t.main.trigger("struct-change")}),t.info,this);this.ids.panle.appendChild(n)}}]),t}())||i},function(t,e,n){var r,i=o(n(12)),a=o(n(13));function o(t){return t&&t.__esModule?t:{default:t}}var u=n(5),s=(n(14),u.React);t.exports=u(r=function(){function t(){(0,i.default)(this,t)}return(0,a.default)(t,[{key:"init",value:function(){this.$dom((function(){return s.createElement("div",null)})),this.css({height:"35px","background-color":"#333","border-bottom":"1px solid #555"})}}]),t}())||r},function(t,e,n){var r=o(n(18)),i=o(n(3)),a=o(n(4));function o(t){return t&&t.__esModule?t:{default:t}}var u,s=n(7),l={};t.exports=(u=(0,a.default)(i.default.mark((function t(e,n,r){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=r||{},"canvas"!=n){t.next=5;break}return t.next=4,p(e,r.canvas);case 4:return t.abrupt("return",t.sent);case 5:if("img"!=n){t.next=9;break}return t.next=8,h(e,r.img);case 8:return t.abrupt("return",t.sent);case 9:if("texture"!=n){t.next=13;break}return t.next=12,m(e,r.texture,r.gl);case 12:return t.abrupt("return",t.sent);case 13:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return u.apply(this,arguments)});var c,f,d,p=(c=(0,a.default)(i.default.mark((function t(e,n){var r,a,o,u;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n||document.createElement("canvas"),a=r.getContext("2d"),o=function(t){return r.width=t.width,r.height=t.height,a.drawImage(t,0,0),{data:r,type:"canvas",width:t.width,height:t.height}},"canvas"!=e.type){t.next=9;break}if(null!=n){t.next=8;break}return t.abrupt("return",{data:e.data,type:"canvas",width:e.data.width,height:e.data.height});case 8:return t.abrupt("return",o(e.data));case 9:if("data-url"!=e.type&&"url"!=e.type){t.next=14;break}return t.next=12,h(e);case 12:return u=t.sent,t.abrupt("return",o(u));case 14:if("img"!=e.type){t.next=16;break}return t.abrupt("return",o(e.data));case 16:if("texture"!=e.type){t.next=24;break}return t.next=19,s.easyFilter(l,{image:e,close_frame:!0});case 19:return t.sent,r.width=e.width,r.height=e.height,a.drawImage(s.canvas,0,0),t.abrupt("return",{data:r,type:"canvas",width:e.width,height:e.height});case 24:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)}),h=(f=(0,a.default)(i.default.mark((function t(e,n){var a,o;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n||new Image,o=function(t){return new r.default((function(e){a.src=t,a.onload=function(){e({data:a,type:"img",width:a.width,height:a.height})}}))},"img"!=e.type){t.next=8;break}if(null!=n){t.next=7;break}return t.abrupt("return",{data:e.data,type:"img",width:e.data.width,height:e.data.height});case 7:return t.abrupt("return",o(e.data.src));case 8:if("data-url"!=e.type&&"url"!=e.type){t.next=12;break}return t.next=11,o(e.data);case 11:return t.abrupt("return",t.sent);case 12:if("canvas"!=e.type){t.next=16;break}return t.next=15,o(e.data.toDataURL());case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t,this)}))),function(t,e){return f.apply(this,arguments)}),m=(d=(0,a.default)(i.default.mark((function t(e,n,r){var a,o,u;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=r||s.gl,a=n||r.createTexture(),o=function(t){return twgl.setTextureFromElement(r,a,t),{data:a,type:"texture",gl:r,width:t.width,height:t.height}},"texture"!=e.type){t.next=6;break}if(null!=r&&r!=e.gl){t.next=6;break}return t.abrupt("return",{data:e.data,type:"texture",gl:r,width:e.width,height:e.height});case 6:if("img"!=e.type&&"canvas"!=e.type&&"video"!=e.type){t.next=8;break}return t.abrupt("return",o(e.data));case 8:if("data-url"!=e.type&&"url"!=e.type){t.next=13;break}return t.next=11,h(e);case 11:return u=t.sent,t.abrupt("return",o(u));case 13:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return d.apply(this,arguments)})},function(t,e,n){var r=o(n(3)),i=o(n(34)),a=o(n(4));function o(t){return t&&t.__esModule?t:{default:t}}var u,s=n(7),l=s.gl;t.exports=(u=(0,a.default)(r.default.mark((function t(e,n){var a,o,u,p,h,m,v,g;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o in a={vs:f,fs:d,width:null,height:null,image:null,uniforms:{},buffers:{position:{data:[-1,-1,1,-1,-1,1,-1,1,1,-1,1,1],numComponents:2},uv:{data:[0,0,1,0,0,1,0,1,1,0,1,1],numComponents:2}},attachments:[{attach:0}],close_frame:!1},n)if("buffers"==o)for(u in n[o])a[o][u]=n[o][u];else a[o]=n[o];if("texture"==a.image.type&&a.image.gl==l){t.next=9;break}return e.filterTexture=e.filterTexture||l.createTexture(),t.next=6,s.getImage(a.image,"texture",{texture:e.filterTexture,gl:l});case 6:p=t.sent,t.next=10;break;case 9:p=(0,i.default)({},a.image);case 10:for(o in a.width=a.width||p.width,a.height=a.height||p.height,a.close_frame&&(a.buffers.uv={data:[0,1,1,1,0,0,0,0,1,1,1,0],numComponents:2}),null==e.filterInfo&&(e.filterInfo=c(a)),(h=e.filterInfo).lastFS==a.fs&&h.lastVS==a.vs||(h.pi=twgl.createProgramInfo(l,[a.vs,a.fs]),h.lastFS=a.fs,h.lastVS=a.vs),a.close_frame?twgl.bindFramebufferInfo(l,null):twgl.bindFramebufferInfo(l,h.fbi),twgl.setBuffersAndAttributes(l,h.pi,h.bi),a.buffers)twgl.setAttribInfoBufferFromArray(l,h.bi.attribs[o],a.buffers[o]);for(o in l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT),!a.close_frame||s.canvas.width==a.width&&s.canvas.height==a.height||(s.canvas.width=a.width,s.canvas.height=a.height,l.viewport(0,0,a.width,a.height)),a.close_frame||h.fbi.width==a.width&&h.fbi.height==a.height||(twgl.resizeFramebufferInfo(l,h.fbi,a.attachments,a.width,a.height),l.viewport(0,0,a.width,a.height)),l.useProgram(h.pi.program),(m=(0,i.default)({},a.uniforms)).uSampler=p.data,m.uSize=[a.width,a.height],twgl.setUniforms(h.pi,m),twgl.drawBufferInfo(l,h.bi),v={outputs:[]},h.fbi.attachments)g={data:h.fbi.attachments[o],type:"texture",width:a.width,height:a.height,gl:l},v.outputs.push(g);return t.abrupt("return",v);case 32:case"end":return t.stop()}}),t,this)}))),function(t,e){return u.apply(this,arguments)});var c=function(t){var e={};if(e.bi=twgl.createBufferInfoFromArrays(l,t.buffers),e.fbi=twgl.createFramebufferInfo(l,t.attachments,t.width,t.height),t.attachments.length>1){var n=0,r=[];for(var i in t.attachments)n++;for(i=0;i<n;i++)r.push(l.COLOR_ATTACHMENT0+i);n>1&&l.drawBuffers(r)}return l.bindTexture(l.TEXTURE_2D,null),e},f="\nattribute vec4 position;\nattribute vec2 uv;\n\nvarying vec2 vUV;\n\nvoid main() {\n\tvUV = uv;\n\tgl_Position = position;\n}",d="\nprecision mediump float;\nvarying vec2 vUV;\n\nuniform sampler2D uSampler;\nuniform vec2 uSize;\n\nvoid main(void){\n\tgl_FragColor = texture2D(uSampler, vUV);\n}\n"},function(t,e,n){(t.exports={}).base=n(164)},function(t,e,n){n(7);var r=n(165),i=n(166),a=n(167),o=n(168),u=n(169),s=n(170);t.exports=function(t){r(t),i(t),o(t),u(t),a(t),s(t)}},function(t,e,n){var r=a(n(3)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=n(5).react;t.exports=function(t){var e;t.addType({name:"图像",key:"image"}),t.addType({name:"变换矩阵",key:"mat4"}),t.addType({name:"体素数据",key:"voxel-data"}),t.addType({name:"文件",key:"file",selector:function(t,e){return o.createElement("input",{type:"file",onchange:function(t){null!=this.files[0]&&e(this.files[0])}})}}),t.addType({name:"浮点数",key:"float",selector:function(t,e,n,r){var i=o.createElement("input",{value:t,style:"width:100%;",type:n.input_type||"number",min:n.min,max:n.max,step:n.step});i.value=t;var a=function(t){var r=Number(this.value);"NaN"==r.toString()&&(r=0),null!=n.min&&r<n.min&&(r=n.min),null!=n.max&&r>n.max&&(r=n.max),this.value=r,e(Number(r))};if("range"==n.input_type){var u=!1;i.onmousedown=function(){u=!0},r.message("mousemove",(function(t){u&&a.call(i,t)})),r.message("mouseup",(function(t){u&&(u=!1)}))}else i.onchange=a;return i}}),t.addModule({name:"变量-浮点数(角度)",menu:["变量","浮点数(角度)"],key:"$$type-vars-float-angle",inputs:[{type:"float",name:"值",key:"value",use_link:!1,input_type:"range",min:0,max:360,step:.1}],outputs:[{type:"float",name:"输出",key:"value"}],run:(e=(0,i.default)(r.default.mark((function t(e){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{value:e.value});case 1:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}),t.addType({name:"字符串",key:"string",selector:function(t,e,n){return o.createElement("input",{value:t||"",style:"width:100%;",type:"text",onchange:function(t){e(this.value)}})}}),t.addType({name:"颜色",key:"color",selector:function(t,e,n){return o.createElement("input",{value:t,type:"color",onchange:function(t){e(this.value)}})},outputUIExpand:function(t){var e=o.createElement("z",{style:"display:inline-block;vertical-align:inherit;width:0.8em;height:0.8em;border-radius:2px;background-color:#000;margin-left:4px;box-shadow:0px 0px 2px rgba(255,255,255,0.5);"});t.ids.after.appendChild(e),t.node.message("run-end",(function(n){var r=n.outputs[t.data.key];e.style["background-color"]=r}))}}),t.addType({name:"代码",key:"code",selector:function(t,e,n){var r={theme:"tomorrow_night",mode:"javascript"};for(var i in n)r[i]=n[i];var a=o.createElement("div",{style:"margin:8px;height:600px;border:1px solid rgba(255,255,255,0.3);"}),u=o.createElement("div",null,a,o.createElement("button",{onclick:function(){e(s.getValue())}},"保存")),s=ace.edit(a);return s.setTheme("ace/theme/"+r.theme),s.getSession().setMode("ace/mode/"+r.mode),s.setValue(t),u}})}},function(t,e,n){var r=o(n(3)),i=o(n(4)),a=o(n(18));function o(t){return t&&t.__esModule?t:{default:t}}var u=n(7),s=n(5);t.exports=function(t){var e,n;t.addModule({name:"选择本地图片",menu:["图像","选择本地图片"],key:"image-file-select",inputs:[{name:"图片文件",type:"file",key:"file",use_link:!1}],outputs:[{type:"image",name:"图像",key:"image"}],init:function(){this.attrs.cache["save-url"]&&(this.urlCache=this.attrs.cache["save-url"],this.attrs.forms.file=null)},run:function(t){var e=this,n=function(t,n){e.img=e.img||new Image,e.img.src=t,e.attrs.cache["save-url"]=t,e.img.onload=function(){e.imgInfo={image:{data:e.img,type:"img",width:e.img.width,height:e.img.height}},n(e.imgInfo)}};if(e.file!=t.file&&(e.urlCache=null),e.urlCache)return new a.default((function(t){n(e.urlCache,t)}));if(e.file&&t.file==e.file&&null!=e.imgInfo)return e.imgInfo;if(null==t.file)throw new Error("没有选择文件");if("image"!=t.file.type.substr(0,5))throw new Error("载入的不是图片文件");if(t.file.size>41943040)throw new Error("载入的文件大于40M载入上限");return e.file=t.file,new a.default((function(e,r){var i=new FileReader;i.onload=function(){n(this.result,e)},i.readAsDataURL(t.file)}))}}),t.addModule({name:"文字",menu:["图像","文字"],key:"image-text",inputs:[{name:"文本",type:"string",key:"text",default:"Hello!"},{name:"字体大小",type:"float",key:"font_size",default:30,step:1,min:1,max:300},{name:"文字颜色",type:"color",key:"font_color",default:"#ffffff"}],outputs:[{type:"image",name:"图像",key:"image"}],init:function(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")},run:(e=(0,i.default)(r.default.mark((function t(e){var n,i,a,o;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.ctx,i=e.text,a="bold "+e.font_size+"px 微软雅黑",n.font=a,o=n.measureText(i),this.canvas.width=Math.floor(o.actualBoundingBoxRight+o.actualBoundingBoxLeft),this.canvas.height=e.font_size+o.actualBoundingBoxDescent,n.font=a,n.fillStyle=e.font_color,n.fillText(i,o.actualBoundingBoxLeft,e.font_size),t.abrupt("return",{image:{data:this.canvas,type:"canvas",width:this.canvas.width,height:this.canvas.height}});case 11:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}),t.addModule({name:"矩形",menu:["图像","矩形"],key:"image-shape-rect",inputs:[{name:"颜色",type:"color",key:"color"},{name:"宽度",type:"float",key:"width",default:720,min:1,max:8192,step:1},{name:"高度",type:"float",key:"height",default:480,min:1,max:8192,step:1}],outputs:[{type:"image",name:"图像",key:"image"}],run:(n=(0,i.default)(r.default.mark((function t(e){var n,i,a;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.texture||u.gl.createTexture(),i=new s.easycolor(e.color),t.next=4,u.easyFilter(this,{image:{data:n,type:"texture",gl:u.gl,width:1,height:1},width:e.width,height:e.height,uniforms:{color:[i.r/256,i.g/256,i.b/256,i.a]},fs:"precision mediump float;\n\t\t\t\tuniform vec4 color;\n\n\t\t\t\tvoid main(void)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = color;\n\t\t\t\t}"});case 4:return a=t.sent,t.abrupt("return",{image:a.outputs[0]});case 6:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})})}},function(t,e,n){var r=o(n(3)),i=o(n(18)),a=o(n(4));function o(t){return t&&t.__esModule?t:{default:t}}var u=n(7);t.exports=function(t){var e,n,o,s;t.addModule({name:"JS代码",menu:["其他","JS代码"],key:"other-js-code-output",inputs:[{type:"code",name:"代码",key:"code",default:"return {};"}],outputs:[{type:"*",name:"输出",key:"out"}],run:(e=(0,a.default)(r.default.mark((function t(e){var n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.lastCode!=e.code&&(this.lastCode=e.code,this.func=new Function(e.code)),!((n=this.func())instanceof i.default)){t.next=6;break}return t.next=5,n;case 5:n=t.sent;case 6:return t.abrupt("return",{out:n});case 7:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}),t.addModule({name:"图像对比",menu:["其他","图像对比"],key:"image-comparison",inputs:[{name:"图像1",type:"image",key:"image1"},{name:"图像2",type:"image",key:"image2"}],outputs:[{type:"image",name:"对比结果",key:"image"}],run:(n=(0,a.default)(r.default.mark((function t(e){var n,i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==this.texture&&(this.texture=u.gl.createTexture()),t.next=3,u.getImage(e.image1,"texture",{texture:this.texture,gl:u.gl});case 3:return n=t.sent,t.next=6,u.easyFilter(this,{image:e.image2,width:2*n.width,height:n.height,uniforms:{weight:e.weight,uSampler1:n.data},fs:"precision mediump float;\n\t\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\t\tuniform sampler2D uSampler1;\n\t\t\t\t\tuniform sampler2D uSampler;\n\t\t\t\t\tuniform vec2 uSize;\n\n\t\t\t\t\tvoid main(void){\n\t\t\t\t\t\t//计算uv\n\t\t\t\t\t\tvec2 uv = vec2(vUV.x * 2.0,vUV.y);\n\n\t\t\t\t\t\t//原图颜色\n\t\t\t\t\t\tif(uv.x < 1.0)\n\t\t\t\t\t\t\tgl_FragColor = texture2D(uSampler1, uv);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tgl_FragColor = texture2D(uSampler, uv - vec2(1.0,0.0));\n\t\t\t\t\t}"});case 6:return i=t.sent,t.abrupt("return",{image:i.outputs[0]});case 8:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}),t.addModule({name:"画布尺寸",menu:["其他","画布尺寸"],key:"image-screen-size",inputs:[{name:"图像",type:"image",key:"image"},{name:"宽度",type:"float",key:"width",default:720,min:1,max:8192,step:1},{name:"高度",type:"float",key:"height",default:480,min:1,max:8192,step:1}],outputs:[{type:"image",name:"图像",key:"image"}],run:(o=(0,a.default)(r.default.mark((function t(e){var n,i,a,o;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.image,i=n.width/e.width,a=n.height/e.height,console.log(i,a,n),t.next=6,u.easyFilter(this,{image:e.image,width:e.width,height:e.height,buffers:{position:{data:[-i,-a,i,-a,-i,a,-i,a,i,-a,i,a],numComponents:2}}});case 6:return o=t.sent,t.abrupt("return",{image:o.outputs[0]});case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})}),t.addModule({name:"主色提取",menu:["其他","主色提取"],key:"other-color-thief",inputs:[{name:"图像",type:"image",key:"image"}],outputs:[{type:"color",name:"主色",key:"color-main"},{type:"color",name:"辅色1",key:"color1"},{type:"color",name:"辅色2",key:"color2"},{type:"color",name:"辅色3",key:"color3"},{type:"color",name:"辅色4",key:"color4"}],run:(s=(0,a.default)(r.default.mark((function t(e){var n,i,a,o,s;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.getImage(e.image,"img");case 2:for(s in n=t.sent,i=new ColorThief,a=new lcg.easycolor(i.getColor(n.data)).toString(),o=i.getPalette(n.data))o[s]=lcg.easycolor(o[s]).toString();return t.abrupt("return",{"color-main":a,color1:o[1],color2:o[2],color3:o[3],color4:o[4]});case 8:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})})}},function(t,e,n){var r=a(n(3)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=n(7),u=n(5);t.exports=function(t){var e,n,a;t.addModule({name:"饱和度",menu:["滤镜","饱和度"],key:"filter-gray",inputs:[{name:"图像",type:"image",key:"image"},{name:"饱和度",type:"float",key:"weight",input_type:"range",default:1,min:0,max:2,step:.01}],outputs:[{type:"image",name:"图像",key:"image"}],run:(e=(0,i.default)(r.default.mark((function t(e){var n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.easyFilter(this,{image:e.image,uniforms:{weight:e.weight},fs:"precision mediump float;\n\t\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\t\tuniform sampler2D uSampler;\n\t\t\t\t\tuniform vec2 uSize;\n\t\t\t\t\tuniform float weight;\n\n\t\t\t\t\tvoid main(void){\n\t\t\t\t\t\t//原图颜色\n\t\t\t\t\t\tvec4 color = texture2D(uSampler, vUV);\n\t\t\t\t\t\t//rgb平均值\n\t\t\t\t\t\tfloat c = (color.r + color.g + color.b) / 3.0;\n\t\t\t\t\t\tgl_FragColor = vec4(\n\t\t\t\t\t\t\t(color.r - c) * weight + c,\n\t\t\t\t\t\t\t(color.g - c) * weight + c,\n\t\t\t\t\t\t\t(color.b - c) * weight + c,\n\t\t\t\t\t\t\tcolor.a\n\t\t\t\t\t\t);\n\t\t\t\t\t}"});case 2:return n=t.sent,t.abrupt("return",{image:n.outputs[0]});case 4:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}),t.addModule({name:"渐变映射",menu:["滤镜","渐变映射"],key:"filter-gradient-mapping",inputs:[{name:"图像",type:"image",key:"image"},{name:"暗色",type:"color",key:"color_d",default:"#470000"},{name:"亮色",type:"color",key:"color_l",default:"#ffe5e5"}],outputs:[{type:"image",name:"图像",key:"image"}],run:(n=(0,i.default)(r.default.mark((function t(e){var n,i,a;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new u.easycolor(e.color_d),i=new u.easycolor(e.color_l),t.next=4,o.easyFilter(this,{image:e.image,uniforms:{color_d:[n.r/256,n.g/256,n.b/256],color_l:[i.r/256,i.g/256,i.b/256]},fs:"precision mediump float;\n\t\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\t\tuniform sampler2D uSampler;\n\t\t\t\t\tuniform vec2 uSize;\n\t\t\t\t\tuniform vec3 color_d;\n\t\t\t\t\tuniform vec3 color_l;\n\n\t\t\t\t\tvoid main(void){\n\t\t\t\t\t\t//原图颜色\n\t\t\t\t\t\tvec4 color = texture2D(uSampler, vUV);\n\t\t\t\t\t\t//rgb平均值\n\t\t\t\t\t\tfloat c = (color.r + color.g + color.b) / 3.0;\n\t\t\t\t\t\tgl_FragColor = vec4((color_l - color_d) * c + color_d,color.a);\n\t\t\t\t\t}"});case 4:return a=t.sent,t.abrupt("return",{image:a.outputs[0]});case 6:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}),t.addModule({name:"颜色叠加",menu:["滤镜","颜色叠加"],key:"filter-color-trans",inputs:[{name:"图像",type:"image",key:"image"},{name:"颜色",type:"color",key:"color",default:"#ffffff"}],outputs:[{type:"image",name:"图像",key:"image"}],run:(a=(0,i.default)(r.default.mark((function t(e){var n,i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new u.easycolor(e.color),t.next=3,o.easyFilter(this,{image:e.image,uniforms:{uColor:[n.r/256,n.g/256,n.b/256]},fs:"precision mediump float;\n\t\t\t\tvarying vec2 vUV;\n\t\t\t\tuniform sampler2D uSampler;\n\t\t\t\tuniform vec3 uColor;\n\n\t\t\t\tvoid main(void)\n\t\t\t\t{\n\t\t\t\t\tvec4 c = texture2D(uSampler,vUV);\n\t\t\t\t\tgl_FragColor = vec4(uColor,c.a);\n\t\t\t\t}"});case 3:return i=t.sent,t.abrupt("return",{image:i.outputs[0]});case 5:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})});var s,l,c,f,d,p=function(t,e){return e=e||1,1/(Math.sqrt(2*Math.PI)*e)*Math.exp(-1*Math.pow(t,2)/(2*Math.pow(e,2)))};window.getGaussMat=function(t){for(var e=((t=t||5)-1)/2,n=[],r=[],i=0;i<t;i++){var a=[];n.push(a);for(var o=0;o<t;o++){var u=Math.sqrt((o-e)*(o-e)+(i-e)*(i-e))/t*2;a.push(p(u))}}var s=0;for(var l in n)for(var c in n[l])s+=n[l][c];for(var l in n)for(var c in n[l])r.push(n[l][c]/s);return r},t.addModule({name:"模糊",menu:["滤镜","模糊"],key:"filter-color-blur",inputs:[{name:"图像",type:"image",key:"image"}],outputs:[{type:"image",name:"图像",key:"image"}],run:(s=(0,i.default)(r.default.mark((function t(e){var n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return new u.easycolor(e.color),this.tex=this.tex||twgl.createTexture(gl,{width:15,height:15,internalFormat:gl.R32F,format:gl.RED,type:gl.FLOAT,mag:gl.NEAREST,min:gl.NEAREST,src:getGaussMat(15)}),t.next=4,o.easyFilter(this,{image:e.image,uniforms:{uGuss:this.tex,uGussSize:15},fs:"precision mediump float;\n\t\t\t\tvarying vec2 vUV;\n\t\t\t\tuniform sampler2D uSampler;\n\t\t\t\tuniform sampler2D uGuss;\n\t\t\t\tuniform float uGussSize;\n\t\t\t\tuniform vec2 uSize;\n\n\t\t\t\tvoid main(void)\n\t\t\t\t{\n\t\t\t\t\tgl_FragColor = vec4(0,0,0,0);\n\t\t\t\t\tfloat py = -(uGussSize - 1.0) / 2.0;\n\t\t\t\t\tfor(float x = 0.0;x < 20.0;x++){\n\t\t\t\t\t\tif(x >= uGussSize)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tfor(float y = 0.0;y < 20.0;y++){\n\t\t\t\t\t\t\tif(y >= uGussSize)\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tvec2 uv = vUV + vec2((py + x) / uSize.x,(py + y) / uSize.y);\n\t\t\t\t\t\t\tgl_FragColor += texture2D(uGuss,vec2(x / uGussSize,y / uGussSize)).r * texture2D(uSampler,uv);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}"});case 4:return n=t.sent,t.abrupt("return",{image:n.outputs[0]});case 6:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})}),t.addModule({name:"柔光",menu:["滤镜","柔光"],key:"filter-blend-light",inputs:[{name:"图像",type:"image",key:"image"},{name:"柔光",type:"image",key:"image_light"}],outputs:[{type:"image",name:"图像",key:"image"}],run:(l=(0,i.default)(r.default.mark((function t(e){var n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.easyFilter(this,{image:e.image,uniforms:{uSampler_light:e.image_light.data},fs:"precision mediump float;\n\t\t\t\tvarying vec2 vUV;\n\t\t\t\tuniform sampler2D uSampler;\n\t\t\t\tuniform sampler2D uSampler_light;\n\n\t\t\t\tvoid main(void)\n\t\t\t\t{\n\t\t\t\t\tvec4 c1 = texture2D(uSampler,vUV);\n\t\t\t\t\tvec4 c2 = texture2D(uSampler_light,vUV);\n\t\t\t\t\tgl_FragColor = vec4(c1.xyz + c2.xyz * 2.0,c1.a);\n\t\t\t\t}"});case 2:return n=t.sent,t.abrupt("return",{image:n.outputs[0]});case 4:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})}),t.addModule({name:"柔光叠加",menu:["滤镜","柔光叠加"],key:"filter-line-color",inputs:[{name:"图像",type:"image",key:"image"},{name:"角度",type:"float",key:"angle",default:0,min:0,max:360,step:.1,input_type:"range"}],outputs:[{type:"image",name:"图像",key:"image"}],run:(c=(0,i.default)(r.default.mark((function t(e){var n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.easyFilter(this,{image:e.image,uniforms:{iAngle:e.angle*Math.PI/180},fs:"precision mediump float;\n\t\t\t\tvarying vec2 vUV;\n\t\t\t\tuniform sampler2D uSampler;\n\t\t\t\t//光线角度\n\t\t\t\tuniform float iAngle;\n\n\t\t\t\tvoid main(void)\n\t\t\t\t{\n\t\t\t\t\tvec4 color = texture2D(uSampler,vUV);\n\t\t\t\t\tif(color.a <= 0.0){\n\t\t\t\t\t\tgl_FragColor = vec4(color.rgb,0);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t//计算渐变比例\n\t\t\t\t\tvec2 angle = vec2(cos(iAngle),sin(iAngle));\n\t\t\t\t\tfloat v = 0.5 - dot(angle,vUV - 0.5);\n\t\t\t\t\tv = max(0.0,min(1.0,v * 0.7));\n\n\t\t\t\t\t//目标混合颜色rgb\n\t\t\t\t\tvec3 end;\n\n\t\t\t\t\t//计算颜色\n\t\t\t\t\tif(v > 0.5){\n\t\t\t\t\t\tend = vec3(\n\t\t\t\t\t\t\tcolor.r + (2.0 * v - 1.0) * (color.r - color.r * color.r),\n\t\t\t\t\t\t\tcolor.g + (2.0 * v - 1.0) * (color.g - color.g * color.g),\n\t\t\t\t\t\t\tcolor.b + (2.0 * v - 1.0) * (color.b - color.b * color.b)\n\t\t\t\t\t\t);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tend = vec3(\n\t\t\t\t\t\t\tcolor.r + (2.0 * v - 1.0) * (sqrt(color.r) - color.r),\n\t\t\t\t\t\t\tcolor.g + (2.0 * v - 1.0) * (sqrt(color.g) - color.g),\n\t\t\t\t\t\t\tcolor.b + (2.0 * v - 1.0) * (sqrt(color.b) - color.b)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tgl_FragColor = vec4(end,color.a);\n\t\t\t\t}"});case 2:return n=t.sent,t.abrupt("return",{image:n.outputs[0]});case 4:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})}),t.addModule({name:"射线投影",menu:["滤镜","射线投影"],key:"filter-light-shadow",inputs:[{name:"图像",type:"image",key:"image"},{name:"角度",type:"float",key:"angle",default:0,min:0,max:360,step:.1,input_type:"range"},{name:"阴影长度",type:"float",key:"len",default:200,min:0,max:500,step:.1,input_type:"range"},{name:"发散角度",type:"float",key:"angleFade",default:15,min:0,max:150,step:.1,input_type:"range"},{name:"阴影浓度",type:"float",key:"alpha",default:1,min:0,max:5,step:.02,input_type:"range"}],outputs:[{type:"image",name:"图像",key:"image"}],run:(f=(0,i.default)(r.default.mark((function t(e){var n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.easyFilter(this,{image:e.image,uniforms:{iAngle:(e.angle+180)*Math.PI/180,iLen:e.len,iLenSamp:Math.max(1,Math.floor(e.len/1.5)),iAngleFade:e.angleFade*Math.PI/180,iFade:1,iAlpha:e.alpha,iInner:0},fs:"precision mediump float;\n\t\t\t\tvarying vec2 vUV;\n\t\t\t\tuniform sampler2D uSampler;\n\t\t\t\tuniform vec2 uSize;\n\t\t\t\t//光线角度\n\t\t\t\tuniform float iAngle;\n\t\t\t\t//阴影距离\n\t\t\t\tuniform float iLen;\n\t\t\t\t//深度采样次数\n\t\t\t\tuniform float iLenSamp;\n\t\t\t\t//发散角度\n\t\t\t\tuniform float iAngleFade;\n\t\t\t\t//减淡深度\n\t\t\t\tuniform float iFade;\n\t\t\t\t//阴影浓度\n\t\t\t\tuniform float iAlpha;\n\t\t\t\t//是否是内阴影\n\t\t\t\tuniform float iInner;\n\n\t\t\t\t//π\n\t\t\t\tconst float PI = 3.14159265358979323846264;\n\t\t\t\t//角度采样次数\n\t\t\t\tconst float COUNT_ANGLE = 24.0;\n\n\t\t\t\t//像素宽度\n\t\t\t\tvec2 thickness;\n\t\t\t\t//命中值\n\t\t\t\tfloat mitValue = 1.0;\n\n\t\t\t\t//是否命中像素\n\t\t\t\tbool mitPix(vec2 p){\n\t\t\t\t\tvec4 color = texture2D(uSampler,p);\n\t\t\t\t\tif(color.a == mitValue)\n\t\t\t\t\t\treturn true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\n\t\t\t\t//投射一个角度\n\t\t\t\tvec2 rayTestOne(float angle){\n\t\t\t\t\tthickness = vec2(1.0 / uSize.x,1.0 / uSize.y);\n\t\t\t\t\t//当前采样点\n\t\t\t\t\tvec2 p = vUV;\n\t\t\t\t\t//当前命中权重\n\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\t\n\t\t\t\t\t//计算步长\n\t\t\t\t\tvec2 step = vec2(cos(angle) * thickness.x,sin(angle) * thickness.y) * iLen / iLenSamp;\n\n\t\t\t\t\t//循环采样\n\t\t\t\t\tfloat len = 0.0;\n\t\t\t\t\tfor(float i = 1.0;i <= 500.0;i++){\n\t\t\t\t\t\tif(i > iLenSamp)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tlen++;\n\t\t\t\t\t\t//步进\n\t\t\t\t\t\tp += step;\n\t\t\t\t\t\tif(mitPix(p))\n\t\t\t\t\t\t\tweight += 1.0;\n\t\t\t\t\t\t//如果权足够则停止采样\n\t\t\t\t\t\tif(weight >= 1.0)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\t//距离比例\n\t\t\t\t\tfloat bl = len / iLenSamp;\n\t\t\t\t\tif(iFade <= 0.0)\n\t\t\t\t\t\tbl = 1.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tbl = min(1.0,(1.0 - bl) / iFade);\n\n\t\t\t\t\tbl = bl * bl;\n\n\t\t\t\t\treturn vec2(weight * bl,len * iLen / iLenSamp);\n\t\t\t\t}\n\n\t\t\t\tvoid main(void)\n\t\t\t\t{\n\t\t\t\t\t//内阴影逻辑转换\n\t\t\t\t\tif(iInner > 0.0)\n\t\t\t\t\t\tmitValue = 0.0;\n\n\t\t\t\t\t//如果在内部则不处理\n\t\t\t\t\tif(mitPix(vUV)){\n\t\t\t\t\t\tgl_FragColor = vec4(0,0,0,0);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t//当前点权重\n\t\t\t\t\tfloat weight = 0.0;\n\n\t\t\t\t\t//无角度则单采样\n\t\t\t\t\tif(iAngleFade == 0.0)\n\t\t\t\t\t\tweight = rayTestOne(iAngle).x;\n\t\t\t\t\telse{\n\t\t\t\t\t\t//当前角度\n\t\t\t\t\t\tfloat angle;\n\t\t\t\t\t\tfloat sangle = iAngle - iAngleFade / 2.0;\n\t\t\t\t\t\tfloat cangle = iAngleFade / COUNT_ANGLE;\n\t\t\t\t\t\t//有角度则多采样\n\t\t\t\t\t\tfor(float i = 0.0;i <= COUNT_ANGLE;i++){\n\t\t\t\t\t\t\tangle = sangle + cangle * i;\n\t\t\t\t\t\t\tweight += rayTestOne(angle).x / COUNT_ANGLE * (1.0 - abs(i - COUNT_ANGLE / 2.0) / COUNT_ANGLE);\n\t\t\t\t\t\t\tif(weight >= 1.0)\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t//内阴影边缘处理\n\t\t\t\t\tif(iInner > 0.0)\n\t\t\t\t\t\tweight *= texture2D(uSampler,vUV).a;\n\t\t\t\t\telse\n\t\t\t\t\t\tweight *= 1.0 - texture2D(uSampler,vUV).a;\n\n\t\t\t\t\t//着色\n\t\t\t\t\tgl_FragColor = vec4(vec3(0,0,0),weight * iAlpha);\n\t\t\t\t}"});case 2:return n=t.sent,t.abrupt("return",{image:n.outputs[0]});case 4:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})}),t.addModule({name:"内高光",menu:["滤镜","内高光"],key:"filter-inner-light",inputs:[{name:"图像",type:"image",key:"image"},{name:"角度",type:"float",key:"angle",default:0,min:0,max:360,step:.1,input_type:"range"},{name:"光照强度",type:"float",key:"str",default:10,min:0,max:40,step:.1,input_type:"range"}],outputs:[{type:"image",name:"图像",key:"image"}],run:(d=(0,i.default)(r.default.mark((function t(e){var n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.angle=e.angle*Math.PI/180/(2*Math.PI)%1*(2*Math.PI),t.next=3,o.easyFilter(this,{image:e.image,uniforms:{iAngle:e.angle,iStr:e.str},fs:"precision mediump float;\n\t\t\t\tvarying vec2 vUV;\n\t\t\t\tuniform sampler2D uSampler;\n\t\t\t\tuniform vec2 uSize;\n\t\t\t\t//光线角度\n\t\t\t\tuniform float iAngle;\n\t\t\t\t//光线模式\n\t\t\t\tuniform float iMode;\n\t\t\t\t//光照强度\n\t\t\t\tuniform float iStr;\n\n\t\t\t\t//光照颜色\n\t\t\t\tvec4 light_color = vec4(1,1,1,1);\n\n\t\t\t\t//整圆角度\n\t\t\t\tconst float DOUBLE_PI = 3.14159265358979323846264 * 2.0;\n\t\t\t\t//角度采样次数\n\t\t\t\tconst float COUNT_ANGLE = 12.0;\n\t\t\t\t//深度采样次数\n\t\t\t\tconst float COUNT_LENGTH = 3.0;\n\t\t\t\t//总深度\n\t\t\t\tconst float LENGTH = 6.0;\n\n\t\t\t\tvec2 thickness;\n\n\t\t\t\t//获取角度差值\n\t\t\t\tfloat getAngleL(float a1,float a2){\n\t\t\t\t\tfloat a_max = max(a1,a2);\n\t\t\t\t\tfloat a_min = min(a1,a2);\n\t\t\t\t\tfloat val = min(abs(a_max - a_min),abs(a_max - a_min - DOUBLE_PI));\n\t\t\t\t\tval = -val / DOUBLE_PI * 4.0 + 1.0;\n\t\t\t\t\tif(val > 0.0)\n\t\t\t\t\t\tval = val * val;\n\t\t\t\t\telse\n\t\t\t\t\t\tval = -val * val;\n\t\t\t\t\t//val = max(0.0,val - 0.3) / 0.7;\n\t\t\t\t\treturn val;\n\t\t\t\t}\n\n\t\t\t\tvoid main(void)\n\t\t\t\t{\n\t\t\t\t\tthickness = vec2(1.0 / uSize.x,1.0 / uSize.y);\n\t\t\t\t\t//当前颜色\n\t\t\t\t\tvec4 color = texture2D(uSampler,vUV);\n\t\t\t\t\t//当前采样点坐标\n\t\t\t\t\tvec2 samp_pos;\n\t\t\t\t\t//采样点颜色\n\t\t\t\t\tvec4 samp_color;\n\t\t\t\t\t//光照权重强度\n\t\t\t\t\tfloat samp_val = 0.0;\n\t\t\t\t\t//采样角度\n\t\t\t\t\tfloat angle;\n\t\t\t\t\t//采样深度\n\t\t\t\t\tfloat length;\n\t\t\t\t\t//深度权重\n\t\t\t\t\tfloat samp_val_len;\n\t\t\t\t\t//角度权重\n\t\t\t\t\tfloat samp_val_angle;\n\n\t\t\t\t\t//透明部分直接返回\n\t\t\t\t\tif(color.a <= 0.0){\n\t\t\t\t\t\tgl_FragColor = color;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t//开始循环深度采样\n\t\t\t\t\tfor(float j = 0.0;j < COUNT_LENGTH;j += 1.0){\n\t\t\t\t\t\tlength = 1.0 - LENGTH * j / COUNT_LENGTH;\n\t\t\t\t\t\tsamp_val_len = (j + 1.0) / COUNT_LENGTH;\n\t\t\t\t\t\tsamp_val_len = samp_val_len * samp_val_len;\n\t\t\t\t\t\t//开始循环角度采样\n\t\t\t\t\t\tfor(float i = 0.0;i < COUNT_ANGLE;i += 1.0){\n\t\t\t\t\t\t\tangle = DOUBLE_PI * i / COUNT_ANGLE;\n\t\t\t\t\t\t\t//计算角度权重\n\t\t\t\t\t\t\tsamp_val_angle = getAngleL(angle,iAngle);\n\t\t\t\t\t\t\t//计算采样点坐标\n\t\t\t\t\t\t\tvec2 samp_pos = vec2(\n\t\t\t\t\t\t\t\tvUV.x + thickness.x * cos(angle) * length,\n\t\t\t\t\t\t\t\tvUV.y + thickness.y * sin(angle) * length\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tsamp_color = texture2D(uSampler, samp_pos);\n\t\t\t\t\t\t\tsamp_val += max(color.a - samp_color.a,0.0) * samp_val_len * samp_val_angle;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t//强度计算\n\t\t\t\t\tsamp_val = samp_val / COUNT_ANGLE / COUNT_LENGTH * iStr;\n\t\t\t\t\tif(samp_val > 1.0)\n\t\t\t\t\t\tsamp_val = 1.0;\n\t\t\t\t\tsamp_val = samp_val * color.a;\n\n\t\t\t\t\t//如果光照模式是纯光照\n\t\t\t\t\tif(iMode == 1.0){\n\t\t\t\t\t\tgl_FragColor = light_color * samp_val;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t//混合颜色\n\t\t\t\t\tif(samp_val >= 0.0)\n\t\t\t\t\t\tgl_FragColor = vec4(color * (1.0 - samp_val) + light_color * samp_val);\n\t\t\t\t\telse{\n\t\t\t\t\t\tsamp_val = -samp_val / color.a * 0.5;\n\t\t\t\t\t\tgl_FragColor = vec4(color * (1.0 - samp_val) + vec4(0,0,0,1) * samp_val);\n\t\t\t\t\t}\n\t\t\t\t}"});case 3:return n=t.sent,t.abrupt("return",{image:n.outputs[0]});case 5:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})})}},function(t,e,n){var r=a(n(3)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=n(7);t.exports=function(t){var e;t.addModule({name:"图层",menu:["布局/合成","图层"],key:"layer-main",inputs:[{name:"图像",type:"image",key:"images",array:!0},{name:"宽度",type:"float",key:"width",default:720,min:1,max:8192,step:1},{name:"高度",type:"float",key:"height",default:480,min:1,max:8192,step:1}],outputs:[{type:"image",name:"图像",key:"image"}],init:function(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")},run:(e=(0,i.default)(r.default.mark((function t(e){var n,i,a,u,s;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.images,this.canvas.width=e.width,this.canvas.height=e.height,t.t0=r.default.keys(n);case 4:if((t.t1=t.t0()).done){t.next=14;break}return i=t.t1.value,t.next=8,o.getImage(n[i],"canvas");case 8:a=t.sent,u=(e.width-a.width)/2,s=(e.height-a.height)/2,this.ctx.drawImage(a.data,u,s),t.next=4;break;case 14:return t.abrupt("return",{image:{data:this.canvas,type:"canvas",width:e.width,height:e.height}});case 15:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})})}},function(t,e,n){var r=a(n(3)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=n(7),u=n(5),s=o.gl,l=new(n(71));t.exports=function(t){var e,n,a;t.addModule({name:"视图旋转矩阵",menu:["体素","视图旋转矩阵"],key:"voxel-mat-view",inputs:[],outputs:[{type:"mat4",name:"矩阵",key:"mat"}],init:function(){var t=this;this.mat4=twgl.m4.rotationZ(0);var e,n,r=!1;u.on("trigger-dom-view-mousedown",(function(t){t=t.vals,r=!0,e=t.x,n=t.y})),u.domEvent(document,"mousemove",(function(i){r&&(r=!0,twgl.m4.rotateY(t.mat4,(i.x-e)/100,t.mat4),twgl.m4.rotateX(t.mat4,-(i.y-n)/100,t.mat4),e=i.x,n=i.y,t.sendMessage("change"))})),u.domEvent(document,"mouseup",(function(t){r&&(r=!1)}))},run:(e=(0,i.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{mat:this.mat4});case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}),t.addModule({name:"对象旋转矩阵",menu:["体素","对象旋转矩阵"],key:"voxel-mat-obj-rotate",inputs:[],outputs:[{type:"mat4",name:"矩阵",key:"mat"}],init:function(){var t=this;this.mat4=twgl.m4.rotationZ(0);var e,n,r=!1;u.on("trigger-dom-view-mousedown",(function(t){t=t.vals,r=!0,e=t.x,n=t.y})),u.domEvent(document,"mousemove",(function(i){r&&(r=!0,twgl.m4.rotateZ(t.mat4,-(i.x-e)/100,t.mat4),twgl.m4.rotateY(t.mat4,(i.y-n)/100,t.mat4),e=i.x,n=i.y,t.sendMessage("change"))})),u.domEvent(document,"mouseup",(function(t){r&&(r=!1)}))},run:(n=(0,i.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{mat:this.mat4});case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}),t.addModule({name:"编程-体素渲染",menu:["体素","编程-体素渲染"],key:"voxel-render-code",inputs:[{type:"mat4",name:"矩阵",key:"mat"},{type:"voxel-data",name:"体素数据",key:"voxel"},{type:"code",name:"glsl代码",key:"code",use_link:!1,default:c,mode:"c_cpp"},{type:"float",name:"uArgs1（0-1）",key:"args1",use_link:!1,default:0,input_type:"range",min:0,max:1,step:.001},{type:"float",name:"uArgs2（0-1）",key:"args2",use_link:!1,default:0,input_type:"range",min:0,max:1,step:.001},{type:"float",name:"uArgs3（0-1）",key:"args3",use_link:!1,default:0,input_type:"range",min:0,max:1,step:.001},{type:"float",name:"uArgs4（0-1）",key:"args4",use_link:!1,default:0,input_type:"range",min:0,max:1,step:.001}],outputs:[{type:"image",name:"图像",key:"image"}],run:(a=(0,i.default)(r.default.mark((function t(e){var n,i,a;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.ctex=this.ctex||twgl.createTexture(s,{target:s.TEXTURE_2D,src:[26,115,232,255,255,229,133,255,210,66,66,255,218,187,142,255],width:4,height:1,format:s.RGBA}),this.tex=this.tex||twgl.createTexture(s,{target:s.TEXTURE_3D,internalFormat:s.R32F,format:s.RED}),n=e.voxel||{data:[0,1,1,0,1,0,0,1],width:2,height:2,depth:2},(null==this.lastVoxel||n!=this.lastVoxel&&n.data!=this.lastVoxel.data)&&(this.lastVoxel=n,(i={width:n.width,height:n.height,depth:n.depth,target:s.TEXTURE_3D,internalFormat:s.R32F,format:s.RED,type:s.FLOAT}).width<100&&(i.mag=s.NEAREST,i.min=s.NEAREST),twgl.setTextureFromArray(s,this.tex,n.data,i)),t.next=6,o.easyFilter(this,{image:{gl:s,data:null,type:"texture",width:1,height:1},width:480,height:480,uniforms:{uViewMat:e.mat,uVoxel:this.tex,uColor:this.ctex,uVoxelSize:[n.width,n.height,n.depth],uArgs1:e.args1,uArgs2:e.args2,uArgs3:e.args3,uArgs4:e.args4},vs:"\n\t\t\t\t#version 300 es\n\t\t\t\tin vec4 position;\n\t\t\t\tin vec2 uv;\n\n\t\t\t\tout vec2 vUV;\n\n\t\t\t\tvoid main() {\n\t\t\t\t  gl_Position = position;\n\t\t\t\t  vUV = uv;\n\t\t\t\t}",fs:l.build(e.code)});case 6:return a=t.sent,t.abrupt("return",{image:a.outputs[0]});case 8:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})})},l.addLib("voxel-base","#version 300 es\nprecision mediump float;\nprecision highp sampler3D;\nin vec2 vUV;\n\nuniform sampler2D uSampler;\nuniform sampler3D uVoxel;\nuniform vec2 uSize;\nuniform mat4 uViewMat;\nuniform sampler2D uColor;\n\nuniform float uArgs1;\nuniform float uArgs2;\nuniform float uArgs3;\nuniform float uArgs4;\n\nout vec4 outColor;\n\n//光线结构体\nstruct Ray {\n    vec3 pos;//起点\n    vec3 step;//步进向量\n};\n\n//获取坐标点的值\nfloat getValue(vec3 pos){\n\tif(pos.x <= 0.0 || pos.x >= 1.0 ||\n\t\tpos.y <= 0.0 || pos.y >= 1.0||\n\t\tpos.z <= 0.0 || pos.z >= 1.0)\n\t\treturn -4096.0;\n\treturn texture(uVoxel,vec3(pos)).r;\n}\n\n//获取光线信息\nRay getRay(float step_num){\n\tfloat bl = 1.8;\n\tRay ray;\n\tray.pos = (uViewMat * vec4(vUV - 0.5,-0.5 * bl,1)).xyz + 0.5;\n\tray.step = (uViewMat * vec4(0,0,1.0 * bl,1)).xyz / step_num;\n\treturn ray;\n}\n\n// 根据hu着色\nvec3 getHuColor(float hu){\n    float off = max(min((hu + 400.0) / (800.0),0.875),0.125);\n    return texture(uColor,vec2(off,0.5)).rgb;\n}\n\n//主函数\nvoid main(void){\n\toutColor = vec4(0,0,0,1);\n\trun();\n}");var c="#include voxel-base;\n\n//投射步数\nfloat step_num = 500.0;\n\nvoid run(){\n\t//根据步数获取投射信息\n\tRay ray = getRay(step_num);\n\t//循环步进\n\tfor(float i = 0.0;i < step_num;i++){\n\t\tray.pos += ray.step;\n\t\t//当碰到实体时输出深度\n\t\tif(getValue(ray.pos) > 0.0){\n\t\t\tfloat c = i / step_num;\n\t\t\toutColor = vec4(c,c,c,1);\n\t\t\treturn;\n\t\t}\n\t}\n}"},function(t,e){t.exports=function(){var t={};this.addLib=function(e,r){t[e]=n(r)},this.build=function(t){return e(n(t))};var e=function e(n,r){var i=!1;null==r&&(i=!0),r=r||{version:null,main:null,includes:{}};var a=n.code;for(var o in null==r.main&&null!=n.main&&(r.main=n.main),null==r.version&&null!=n.version&&(r.version=n.version),n.includes){var u=n.includes[o];if(!r.includes[u.lib]){if(r.includes[u.lib]=!0,null==t[u.lib])throw new Error("引入了没有定义的资源["+u.lib+"]");var s=e(t[u.lib],r);a=a.replace(new RegExp("\\{\\{include\\:"+u.lib+"\\}\\}","g"),s)}}return i&&(r.version&&(a=r.version+"\n"+a),r.main&&(a=a+"\n"+r.main),a=a.replace(/\n{3,}/g,"\n\n")),a},n=function(t){var e=t.split("\n"),n={includes:[],version:null,code:"",main:null};for(var r in e){var i=e[r].replace(/^\s+/g,""),a=i.match(/[a-zA-Z0-9_-]+|\(|\)|\{|\}|\s|\#|.;/g)||[];if("#"!=a[0]||"version"!=a[1]){if("main"==a[2]&&("("==a[3]||"("==a[4])){for(var o=[],u=r;u<e.length;u++)o.push(e[u]);n.main=o.join("\n");break}"#"==a[0]&&"include"==a[1]&&(n.includes.push({lib:a[3]}),e[r]="{{include:"+a[3]+"}}"),n.code+="\n"+e[r]}else n.version=i}return n}}},function(t,e,n){(t.exports=n(72)).mapModule=n(175)},function(t,e,n){var r=n(49);t.exports=function(t,e){var n=this,o={vs:i,fs:a,buffers:{position:{data:[-1,-1,1,-1,-1,1,-1,1,1,-1,1,1],numComponents:2},uv:{data:[0,0,1,0,0,1,0,1,1,0,1,1],numComponents:2}}};for(var u in t)o[u]=t[u];var s=e.gl,l=n.pi=twgl.createProgramInfo(s,[r.build(o.vs),r.build(o.fs)]),c=n.bi=twgl.createBufferInfoFromArrays(s,o.buffers);twgl.setBuffersAndAttributes(s,l,c),this.run=function(t){s.useProgram(l.program),twgl.setBuffersAndAttributes(s,l,c),e.run(t,n)}};var i="\n#version 300 es\nin vec4 position;\nin vec2 uv;\n\nout vec2 vUV;\n\nvoid main() {\n  gl_Position = position;\n  vUV = uv;\n}",a="#version 300 es\nprecision highp float;\n\nin vec2 vUV;\n\nuniform int type;\nuniform sampler2D uPs;\nuniform sampler2D uVs;\nuniform sampler2D uGs;\n\nlayout (location = 0) out vec4 oPs;\nlayout (location = 1) out vec4 oVs;\nlayout (location = 2) out vec4 oGs;\n\nvoid main() {\n\toPs = texture(uPs,vUV);\n\toVs = texture(uVs,vUV);\n\toGs = texture(uGs,vUV);\n}\n"},function(t,e,n){var r=n(49);t.exports=function(t,e){var n={vs:i,fs:a,buffers:{position:{data:[0,0,0],numComponents:3}}};for(var o in t)n[o]=t[o];var u=e.gl,s=this.pi=twgl.createProgramInfo(u,[r.build(n.vs),r.build(n.fs)]),l=this.bi=twgl.createBufferInfoFromArrays(u,n.buffers);twgl.setBuffersAndAttributes(u,s,l);var c=this.fbi=twgl.createFramebufferInfo(u,[{}],1,1);this.render=function(){var t={width:480,height:480,fbi:e.getFrameBuffer(),uniforms:{},type:u.POINTS};u.useProgram(s.program),twgl.setBuffersAndAttributes(u,s,l),twgl.bindFramebufferInfo(u,c),c.width==t.width&&c.height==t.height||twgl.resizeFramebufferInfo(u,c,[{}],t.width,t.height),u.viewport(0,0,t.width,t.height);var n=e.writeUniform(t);twgl.setUniforms(s,n),u.clearColor(0,0,0,0),u.clear(u.COLOR_BUFFER_BIT),u.enable(u.BLEND),u.blendFunc(u.ONE,u.ONE),twgl.drawBufferInfo(u,l,t.type,l.numElements,0,n.uCount)}};var i="\n//基本定义\n#include base-data;\nin vec4 position;\n\nvoid main() {\n\tif(float(gl_InstanceID) >= uCount){\n\t\tgl_PointSize = 0.0;\n\t\treturn;\n\t}\n\tParticle p = getParticleOfIndex(float(gl_InstanceID));\n\tif(p.weight == 0.0)\n\t\treturn;\n\tgl_Position = vec4(p.position.xyz * 0.5,1.0);\n\tgl_PointSize = 1.0 / (1.5 - p.position.z) * 10.0;\n\tgl_Position.z = 0.0;\n}",a="#version 300 es\nprecision highp float;\n\nout vec4 color;\n\nvoid main() {\n\t// 距离\n    float dist = distance(gl_PointCoord, vec2(0.5, 0.5)) * 2.0;\n    dist = min(max(1.0 - dist,0.0),1.0);\n    dist = dist * dist;\n    //dist = dist * 0.1;\n\tcolor = vec4(1.0, 1.0, 1.0, dist);\n}\n"},function(t,e,n){var r=a(n(3)),i=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var o=n(72),u=n(7),s=n(49);t.exports=function(t){var e;t.addType({name:"粒子处理器",key:"particle-core"}),t.addModule({name:"创建粒子处理器",menu:["粒子","创建粒子处理器"],key:"particle-core-create",outputs:[{type:"particle-core",name:"粒子核心",key:"core"}],init:function(){this.core=new o({canvas:u.canvas,gl:u.gl})},run:function(t){return{core:this.core}}}),t.addModule({name:"粒子发射器",menu:["粒子","粒子发射器"],key:"particle-send",inputs:[{type:"particle-core",name:"粒子核心",key:"core"}],outputs:[{type:"particle-core",name:"粒子核心",key:"core"}],run:function(t){return this.effect=this.effect||t.core.createEffector({fs:"\n\t\t\t\t#include pf-main;\n\t\t\t\tvoid run(){\n\t\t\t\t\t//没有生命线则初始化\n\t\t\t\t\tif(p.life == 0.0){\n\t\t\t\t\t\t//随机坐标\n\t\t\t\t\t\tp.position.x = rand() * 2.0 - 1.0;\n\t\t\t\t\t\tp.position.y = rand() * 2.0 - 1.0;\n\t\t\t\t\t\tp.position.z = rand() * 2.0 - 1.0;\n\t\t\t\t\t\t//随机速度\n\t\t\t\t\t\tp.velocity.x = (rand() * 2.0 - 1.0);\n\t\t\t\t\t\tp.velocity.y = (rand() * 2.0 - 1.0);\n\t\t\t\t\t\tp.velocity.z = (rand() * 2.0 - 1.0);\n\t\t\t\t\t\t//写入生命线\n\t\t\t\t\t\tp.life = 1.0;\n\t\t\t\t\t\t//随机权重\n\t\t\t\t\t\tp.weight = rand();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t"}),this.effect.run(),t}}),t.addModule({name:"重力/速度处理",menu:["粒子","重力/速度处理"],key:"particle-gv-jax",inputs:[{type:"particle-core",name:"粒子核心",key:"core"}],outputs:[{type:"particle-core",name:"粒子核心",key:"core"}],run:function(t){return this.effect=this.effect||t.core.createEffector({fs:"\n\t\t\t\t#include pf-main;\n\t\t\t\tvoid run(){\n\t\t\t\t\tif(p.life != 0.0){\n\t\t\t\t\t\t//根据重力调整速度\n\t\t\t\t\t\tp.velocity += p.gravity / 120.0;\n\t\t\t\t\t\t//根据速度调整坐标\n\t\t\t\t\t\tp.position += p.velocity / 120.0;\n\t\t\t\t\t\t//清除重力\n\t\t\t\t\t\tp.gravity = vec3(0,0,0);\n\t\t\t\t\t\t//阻力\n\t\t\t\t\t\t//p.velocity = p.velocity * 0.9985;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t"}),this.effect.run(),t}}),t.addModule({name:"引力点",menu:["粒子","引力点"],key:"particle-g-point",inputs:[{type:"particle-core",name:"粒子核心",key:"core"},{type:"float",name:"x",key:"x",step:.01,min:-2,max:2,default:0,input_type:"range",use_link:!1},{type:"float",name:"y",key:"y",step:.01,min:-2,max:2,default:0,input_type:"range",use_link:!1},{type:"float",name:"z",key:"z",step:.01,min:-2,max:2,default:0,input_type:"range",use_link:!1},{type:"float",name:"引力强度",key:"str",step:.01,min:0,max:20,default:3,input_type:"range",use_link:!1}],outputs:[{type:"particle-core",name:"粒子核心",key:"core"}],run:function(t){return this.effect=this.effect||t.core.createEffector({fs:"\n\t\t\t\t#include pf-main;\n\n\t\t\t\tuniform vec3 uGPoint;\n\t\t\t\tuniform float uStr;\n\n\t\t\t\tvoid run(){\n\t\t\t\t\tif(p.life != 0.0){\n\t\t\t\t\t\t//重力写入\n\t\t\t\t\t\tp.gravity += normalize(uGPoint - p.position) / max(0.5,distance(uGPoint,p.position)) * uStr;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t"}),this.effect.run({uniforms:{uGPoint:[t.x,t.y,t.z],uStr:t.str}}),t}}),t.addModule({name:"涡流",menu:["粒子","涡流"],key:"particle-g-rotate",inputs:[{type:"particle-core",name:"粒子核心",key:"core"}],outputs:[{type:"particle-core",name:"粒子核心",key:"core"}],run:function(t){return this.effect=this.effect||t.core.createEffector({fs:"\n\t\t\t\t#include pf-main;\n\n\t\t\t\tuniform vec3 uGPoint;\n\t\t\t\tuniform float uStr;\n\n\t\t\t\tmat3 rmat = mat3(0,-1,0,   1,0,0,  0,0,1);\n\n\t\t\t\tvoid run(){\n\t\t\t\t\tif(p.life != 0.0){\n\t\t\t\t\t\t//重力写入\n\t\t\t\t\t\tvec3 g = vec3((rmat * vec3(vec2(normalize(p.position.xy - vec2(0,0))),1.0)).xy,0.0) * (0.8 + rand() * 2.0);\n\t\t\t\t\t\tg = g * 0.3;\n\t\t\t\t\t\tp.gravity += g;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t"}),this.effect.run({uniforms:{uGPoint:[t.x,t.y,t.z],uStr:t.str}}),t}}),t.addModule({name:"粒子贴图显示",menu:["粒子","粒子贴图显示"],key:"particle-texture-show",inputs:[{type:"particle-core",name:"粒子核心",key:"core"}],outputs:[{type:"image",name:"图像",key:"image"}],run:function(t){var e=t.core.getFrameBuffer();return{image:{data:e.attachments[0],type:"texture",gl:t.core.gl,width:e.width,height:e.height}}}}),t.addModule({name:"粒子-点渲染",menu:["粒子","点渲染"],key:"particle-renderer-point",inputs:[{type:"particle-core",name:"粒子核心",key:"core"}],outputs:[{type:"image",name:"图像",key:"image"}],run:function(t){this.renderer=this.renderer||t.core.createRenderer(),this.renderer.render();var e=this.renderer.fbi;return{image:{data:e.attachments[0],type:"texture",gl:t.core.gl,width:e.width,height:e.height}}}}),t.addModule({name:"粒子-球体渲染",menu:["粒子","球体渲染"],key:"particle-renderer-voxel-rh",inputs:[{type:"particle-core",name:"粒子核心",key:"core"}],outputs:[{type:"image",name:"图像",key:"image"},{type:"image",name:"光照贴图",key:"image_light"}],run:(e=(0,i.default)(r.default.mark((function t(e){var n,i,a;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.core.getFrameBuffer(),i=e.core.writeUniform(),t.next=4,u.easyFilter(this,{image:{data:n.attachments[0],type:"texture",gl:e.core.gl,width:n.width,height:n.height},attachments:[{attach:0},{attach:1}],uniforms:i,width:480,height:480,vs:"\n\t\t\t\t#version 300 es\n\t\t\t\tin vec4 position;\n\t\t\t\tin vec2 uv;\n\n\t\t\t\tout vec2 vUV;\n\n\t\t\t\tvoid main() {\n\t\t\t\t  gl_Position = position;\n\t\t\t\t  vUV = uv;\n\t\t\t\t}\n\t\t\t\t",fs:s.build("\n\t\t\t\t\t#include base-data;\n\n\t\t\t\t\tuniform sampler2D uSampler;\n\n\t\t\t\t\tstruct Ray {\n\t\t\t\t\t    vec3 o;//起点\n\t\t\t\t\t    vec3 d;//方向\n\t\t\t\t\t    float t;//距离\n\t\t\t\t\t    bool isHit;//是否击中\n\t\t\t\t\t    vec3 pos;//击中点位置\n\t\t\t\t\t    vec3 normal;//击中点法线\n\t\t\t\t\t    vec4 color;//当前命中点颜色\n\t\t\t\t\t    float count;//命中次数\n\t\t\t\t\t    vec4 pinfo;//命中的点数据\n\t\t\t\t\t};\n\n\t\t\t\t\t//光线和球体求交\n\t\t\t\t\tbool intersectSphere(inout Ray ray, vec3 sphereCenter, float sphereRadius) {\n\t\t\t\t\t    vec3 toSphere = ray.o - sphereCenter;\n\t\t\t\t\t    float a = dot(ray.d, ray.d);\n\t\t\t\t\t    float b = 2.0 * dot(toSphere, ray.d);\n\t\t\t\t\t    float c = dot(toSphere, toSphere) - sphereRadius*sphereRadius;\n\t\t\t\t\t    float discriminant = b*b - 4.0*a*c;\n\n\t\t\t\t\t    if(discriminant > 0.0) {\n\t\t\t\t\t        float t = (-b - sqrt(discriminant)) / (2.0 * a);\n\t\t\t\t\t        if(t > 0.0 && t < ray.t){\n\t\t\t\t\t            ray.isHit = true;\n\t\t\t\t\t            ray.t = t;\n\t\t\t\t\t            ray.pos = ray.o + ray.d * t;\n\t\t\t\t\t            ray.normal = normalize(ray.pos - sphereCenter);\n\t\t\t\t\t            return true;\n\t\t\t\t\t        }\n\t\t\t\t\t    }\n\t\t\t\t\t    return false;\n\t\t\t\t\t}\n\n\t\t\t\t\tin vec2 vUV;\n\t\t\t\t\tlayout (location = 0) out vec4 color;\n\t\t\t\t\tlayout (location = 1) out vec4 color_light;\n\n\t\t\t\t\t//命中一次\n\t\t\t\t\tvoid hitOne(inout Ray ray){\n\t\t\t\t\t\tray.t = 10000.0;\n\t\t\t\t\t\tray.isHit = false;\n\t\t\t\t\t\tfor(float index = 0.0;index < 2000.0 && index < uCount;index++){\n\t\t\t\t\t\t\tvec4 pinfo = texture(uPs,getUVOfIndex(index));\n\t\t\t\t\t\t\tif(intersectSphere(ray,pinfo.xyz,0.1))\n\t\t\t\t\t\t\t\tray.pinfo = pinfo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvec3 c1 = vec3(144,117,50) / 256.0;\n\t\t\t\t\tvec3 c2 = vec3(224,211,139) / 256.0;\n\n\t\t\t\t\tvoid main(void){\n\t\t\t\t\t\t//生成光线\n\t\t\t\t\t\tRay ray,fray;\n\t\t\t\t\t\tray.o = vec3(0,0,-4.0);\n\t\t\t\t\t\tray.d = normalize(vec3(vUV.x - 0.5,vUV.y - 0.5,1.0) * 2.0);\n\t\t\t\t\t\tray.color = vec4(0,0,0,0.0);\n\t\t\t\t\t\tcolor_light = vec4(0,0,0,0);\n\t\t\t\t\t\t//循环投射\n\t\t\t\t\t\tfor(float i = 0.0;i < 3.0;i++){\n\t\t\t\t\t\t\thitOne(ray);\n\t\t\t\t\t\t\t//没有命中跳出\n\t\t\t\t\t\t\tif(!ray.isHit)\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tif(ray.count == 0.0)\n\t\t\t\t\t\t\t\tfray = ray;\n\t\t\t\t\t\t\tray.o = ray.pos;\n\t\t\t\t\t\t\tray.d = ray.d + ray.normal * 2.0;\n\t\t\t\t\t\t\tray.count++;\n\t\t\t\t\t\t\tvec4 color_now;\n\t\t\t\t\t\t\tif(ray.pinfo.a < 0.1){\n\t\t\t\t\t\t\t\tcolor_now = vec4(0,0.81,1.0,1.0);\n\t\t\t\t\t\t\t\tcolor_light = vec4(0,0.81,1.3,1.0) * pow(0.7,ray.count - 1.0);\n\t\t\t\t\t\t\t\ti = 99.0;\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t//颜色\n\t\t\t\t\t\t\t\tfloat d = abs(dot(fray.d,fray.normal));\n\t\t\t\t\t\t\t\tcolor_now = vec4(d * c1 + (1.0 - d) * c2,1.0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(ray.count == 1.0)\n\t\t\t\t\t\t\t\tray.color = color_now;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tray.color = vec4(ray.color * 0.3 + color_now * 0.7);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//如果次数为0\n\t\t\t\t\t\tif(ray.count == 0.0){\n\t\t\t\t\t\t\tcolor = vec4(0,0,0,1.0);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcolor = ray.color;\n\t\t\t\t\t}")});case 4:return a=t.sent,t.abrupt("return",{image:a.outputs[0],image_light:a.outputs[1]});case 6:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})})}}]);